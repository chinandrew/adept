<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Walking strides segmentation with adept • adept</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Walking strides segmentation with adept">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adept</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/adept-intro.html">Introduction to adept package</a>
    </li>
    <li>
      <a href="../articles/adept-strides-segmentation.html">Walking strides segmentation with adept</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/martakarass/adept">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Walking strides segmentation with adept</h1>
                        <h4 class="author">Marta Karas</h4>
            
            <h4 class="date">2019-04-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/martakarass/adept/blob/master/vignettes/adept-strides-segmentation.Rmd"><code>vignettes/adept-strides-segmentation.Rmd</code></a></small>
      <div class="hidden name"><code>adept-strides-segmentation.Rmd</code></div>

    </div>

    
    
<p>This vignette provides an example of walking stride segmentation from subsecond accelerometry data with <code>adept</code> package. We demonstrate that ADEPT method ([1]) can be used to perform automatic and precise walking stride segmentation from data collected during a combination of running, walking and resting exercise. We demonstrate how to segment data:</p>
<ol style="list-style-type: lower-roman">
<li>with the use of stride templates that were pre-computed based on data from an external study,</li>
<li>by deriving new stride templates in a semi-manual manner.</li>
</ol>
<p>See <a href="https://martakarass.github.io/adept/articles/adept-intro.html">Introduction to adept package</a> vignette for an introduction to the ADEPT method and usage examples of the <code>segmentPattern</code> function which implements the ADEPT method.</p>
<div id="raw-accelerometry-data-sample" class="section level1">
<h1 class="hasAnchor">
<a href="#raw-accelerometry-data-sample" class="anchor"></a>Raw accelerometry data sample</h1>
<p>The <code>adept</code> package comes with <code>acc_running</code> data - a sample of raw accelerometry data collected during 25 minutes of an outdoor run. Data were collected at frequency 100 Hz with two ActiGraph GT9X Link sensors located at left hip and left ankle.</p>
<div id="running-trial" class="section level3">
<h3 class="hasAnchor">
<a href="#running-trial" class="anchor"></a>Running trial</h3>
<p><em>mapmyrun</em> mobile tracking application (<a href="mapmyrun.com">link</a>) was used during 25 minutes of run corresponding to <code>acc_running</code> accelerometry data set. Based on the app, the distance covered is approximately 3.35 km. A ground elevation plot from the app output indicates some trial signatures, including an uphill part on the north side of the Patterson Park in Baltimore, MD. The <code>acc_running</code> data sample is a subset of accelerometry data collected over a few days time; the sample attached should match the time while an app was turned on up to ~1-minute accuracy.</p>
<p><img src="https://imgur.com/VcK6o7o.jpg" width="90%"><small><small><small> Screenshot taken from a personal profile of <em>mapmyrun</em> tracking application, accessed via <a href="https://www.mapmyrun.com" class="uri">https://www.mapmyrun.com</a>. </small></small></small></p>
</div>
<div id="sensor-and-accelerometry-data" class="section level3">
<h3 class="hasAnchor">
<a href="#sensor-and-accelerometry-data" class="anchor"></a>Sensor and accelerometry data</h3>
<p>The data were collected with two ActiGraph GT9X Link sensors at frequency 100 Hz. <a href="https://www.actigraphcorp.com/actigraph-link/">ActiGraph GT9X Link</a> is an activity monitor which includes 3-axis accelerometer measuring body acceleration along three orthogonal axes. At frequency 100 Hz, 100 observations are collected each second, where each observation consists of 3 data points (one data point from each of three orthogonal axes), yielding a total of 300 data points per second.</p>
</div>
<div id="sensor-location" class="section level3">
<h3 class="hasAnchor">
<a href="#sensor-location" class="anchor"></a>Sensor location</h3>
<p>One of the sensors was attached to the shoe with a clip on the outside side of a left foot, just below the left ankle. The other sensor was attached to the elastic belt located at the hip, on the left side of a hip. Both devices stayed in a fairly stable way during the run.</p>
<p><img src="https://imgur.com/5Ji2hQF.jpg" width="45%"><img src="https://imgur.com/lTdCixX.jpg" width="45%"><small><small><small> Wearable accelerometer devices location during the experiment. The devices were still covered with a protective plastic foil. </small></small></small></p>
</div>
<div id="data-set-acc_running" class="section level3">
<h3 class="hasAnchor">
<a href="#data-set-acc_running" class="anchor"></a>Data set <code>acc_running</code>
</h3>
<p>The sample accelerometry data is attached to the package as <code>acc_running</code> data frame. To access the data, load <code>adept</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># devtools::install_github("martakarass/adept")</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(adept)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(lubridate)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">digits.secs =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(acc_running)</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt;        x      y     z       vm              date_time sensor_location</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt; 1 -0.199 -1.012 0.133 1.039920 2018-10-25 17:57:30.00        left_hip</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt; 2 -0.191 -1.027 0.133 1.053043 2018-10-25 17:57:30.00        left_hip</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt; 3 -0.191 -1.035 0.121 1.059409 2018-10-25 17:57:30.01        left_hip</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt; 4 -0.191 -1.027 0.109 1.050281 2018-10-25 17:57:30.02        left_hip</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#&gt; 5 -0.191 -1.016 0.109 1.039528 2018-10-25 17:57:30.03        left_hip</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co">#&gt; 6 -0.184 -1.012 0.121 1.035684 2018-10-25 17:57:30.04        left_hip</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="kw"><a href="http://lubridate.tidyverse.org/reference/tz.html">tz</a></span>(acc_running<span class="op">$</span>date_time)</a>
<a class="sourceLine" id="cb1-15" title="15"><span class="co">#&gt; [1] "UTC"</span></a></code></pre></div>
<p><code>acc_running</code> consists of 300,000 observations of 5 variables:</p>
<ul>
<li>
<code>x</code> - acceleration measurement time series collected from a <span class="math inline">\(x\)</span>-axis of the sensor accelerometer,</li>
<li>
<code>y</code> - acceleration measurement time series collected from a <span class="math inline">\(y\)</span>-axis of the sensor accelerometer,</li>
<li>
<code>x</code> - acceleration measurement time series collected from a <span class="math inline">\(z\)</span>-axis of the sensor accelerometer,</li>
<li>
<code>vm</code> - vector magnitude of <span class="math inline">\((x,y,z)\)</span> vector of measurements, computed as <span class="math inline">\(vm = \sqrt{x^2+y^2+z^2}\)</span>,</li>
<li>
<code>date_time</code> - date and time of acceleration measurement collection stored as <code>POSIXct</code>,</li>
<li>
<code>sensor_location</code> - sensor location label, one of: <code>"left_hip"</code>, <code>"left_ankle"</code>.</li>
</ul>
<div id="note-on-date_time-column-values" class="section level5">
<h5 class="hasAnchor">
<a href="#note-on-date_time-column-values" class="anchor"></a>Note on <code>date_time</code> column values</h5>
<ul>
<li>Seemingly, there is an error in <code>date_time</code> column: we would expect its second value to be <code>17:57:30.01</code>, not: <code>17:57:30.00</code>. Values in <code>date_time</code> column were generated via <code><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq(from = as.POSIXct("2018-10-25 17:57:30.00", tz = "UTC"), by = 0.01, length.out = 150000)</a></code>. I identify the problem to be the floating point arithmetic problem, as discussed in <a href="https://stackoverflow.com/questions/11571105/odd-behavor-with-posixct-posixlt-and-subsecond-accuracy">this SO question</a>. Such errors are “made up for” over the column values, and the whole <code>date_time</code> has expected range of time.</li>
</ul>
<p>Time collection spans 25 minutes. It agrees with a number of observations per sensor we have (<code>150000</code>), given the data was collected at frequency 100 observations per second.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/range">range</a></span>(acc_running<span class="op">$</span>date_time)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">#&gt; [1] "2018-10-25 17:57:30.00 UTC" "2018-10-25 18:22:29.99 UTC"</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/table">table</a></span>(acc_running<span class="op">$</span>sensor_location)</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; left_ankle   left_hip </span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt;     150000     150000</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="dv">150000</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="dv">60</span>)  </a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt; [1] 25</span></a></code></pre></div>
</div>
</div>
</div>
<div id="accelerometry-data-visualization" class="section level1">
<h1 class="hasAnchor">
<a href="#accelerometry-data-visualization" class="anchor"></a>Accelerometry data visualization</h1>
<div id="raw-accelerometry-data" class="section level3">
<h3 class="hasAnchor">
<a href="#raw-accelerometry-data" class="anchor"></a>Raw accelerometry data</h3>
<p>One way to visualize raw accelerometry data is to plot it as a three-dimensional time-series <span class="math inline">\((x,y,z)\)</span>. Here, we plot data from three different time frames, each of 4 seconds length, simultaneously for data collected at left ankle and right ankle.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(lubridate)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(reshape2)</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(gridExtra)</a>
<a class="sourceLine" id="cb3-6" title="6"></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">## Define time frame start values for data subset</span></a>
<a class="sourceLine" id="cb3-8" title="8">t1 &lt;-<span class="st"> </span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_hms</a></span>(<span class="st">"2018-10-25 18:07:00"</span>, <span class="dt">tz =</span> <span class="st">"UTC"</span>) </a>
<a class="sourceLine" id="cb3-9" title="9">t2 &lt;-<span class="st"> </span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_hms</a></span>(<span class="st">"2018-10-25 18:20:30"</span>, <span class="dt">tz =</span> <span class="st">"UTC"</span>) </a>
<a class="sourceLine" id="cb3-10" title="10">t3 &lt;-<span class="st"> </span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_hms</a></span>(<span class="st">"2018-10-25 18:22:00"</span>, <span class="dt">tz =</span> <span class="st">"UTC"</span>) </a>
<a class="sourceLine" id="cb3-11" title="11"></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">## Subset data </span></a>
<a class="sourceLine" id="cb3-13" title="13">acc_running_sub &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="st">  </span>acc_running <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>((date_time <span class="op">&gt;=</span><span class="st"> </span>t1 <span class="op">&amp;</span><span class="st"> </span>date_time <span class="op">&lt;</span><span class="st"> </span>t1 <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/as.period.html">as.period</a></span>(<span class="dv">4</span>, <span class="st">"seconds"</span>)) <span class="op">|</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="st">           </span>(date_time <span class="op">&gt;=</span><span class="st"> </span>t2 <span class="op">&amp;</span><span class="st"> </span>date_time <span class="op">&lt;</span><span class="st"> </span>t2 <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/as.period.html">as.period</a></span>(<span class="dv">4</span>, <span class="st">"seconds"</span>)) <span class="op">|</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="st">           </span>(date_time <span class="op">&gt;=</span><span class="st"> </span>t3 <span class="op">&amp;</span><span class="st"> </span>date_time <span class="op">&lt;</span><span class="st"> </span>t3 <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/as.period.html">as.period</a></span>(<span class="dv">4</span>, <span class="st">"seconds"</span>)) )</a>
<a class="sourceLine" id="cb3-18" title="18"></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">## Plot (x,y,z) values </span></a>
<a class="sourceLine" id="cb3-20" title="20">acc_running_sub <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>vm) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/reshape2/topics/melt">melt</a></span>(<span class="dt">id.vars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"date_time"</span>, <span class="st">"sensor_location"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">dt_floor =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"time frame start: "</span>, </a>
<a class="sourceLine" id="cb3-24" title="24">                           <span class="kw"><a href="http://lubridate.tidyverse.org/reference/round_date.html">floor_date</a></span>(date_time, <span class="dt">unit =</span> <span class="st">"minutes"</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> date_time, <span class="dt">y =</span> value, <span class="dt">color =</span> variable)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-26" title="26"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">size =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/facet_grid">facet_grid</a></span>(sensor_location <span class="op">~</span><span class="st"> </span>dt_floor, <span class="dt">scales =</span> <span class="st">"free_x"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"Time [s]"</span>, <span class="dt">y =</span> <span class="st">"Acceleration [g]"</span>, <span class="dt">color =</span> <span class="st">"Accelerometer axis of measurement: "</span>,</a>
<a class="sourceLine" id="cb3-30" title="30">       <span class="dt">title =</span> <span class="st">"Raw accelerometry data (x,y,z)"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-31" title="31"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"top"</span>)</a></code></pre></div>
<p><img src="adept-strides-segmentation_files/figure-html/plot_xyz-1.png" width="720"></p>
<div id="note-on-sensors-desynchronization" class="section level5">
<h5 class="hasAnchor">
<a href="#note-on-sensors-desynchronization" class="anchor"></a>Note on sensors desynchronization</h5>
<ul>
<li>The two sensors used in experiment were set up to initialize their measurement collection at the same time. However, as discussed in [2], even when simultaneous initialization of the devices is used, measurements might still get desynchronized between devices after hours and/or days of data collection. For that possible reason, one should not expect 0.01 second-level alignment between the data collected form left ankle and left hip on the plots above.</li>
</ul>
</div>
</div>
<div id="vector-magnitude" class="section level3">
<h3 class="hasAnchor">
<a href="#vector-magnitude" class="anchor"></a>Vector magnitude</h3>
<p>Using vector magnitude <span class="math inline">\((vm)\)</span> is a way to summarize a three-dimensional time-series <span class="math inline">\((x,y,z)\)</span> as a one-dimensional time-series. Vector magnitude is computed as <span class="math inline">\(vm = \sqrt{x^2 + y^2 + z^2}\)</span> at each time point of data collection.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co">## Plot vector magnitude values </span></a>
<a class="sourceLine" id="cb4-2" title="2">acc_running_sub <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">dt_floor =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"time frame start: "</span>, </a>
<a class="sourceLine" id="cb4-4" title="4">                           <span class="kw"><a href="http://lubridate.tidyverse.org/reference/round_date.html">floor_date</a></span>(date_time, <span class="dt">unit =</span> <span class="st">"minutes"</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> date_time, <span class="dt">y =</span> vm)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">size =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/facet_grid">facet_grid</a></span>(sensor_location <span class="op">~</span><span class="st"> </span>dt_floor, <span class="dt">scales =</span> <span class="st">"free_x"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"Time [s]"</span>, <span class="dt">y =</span> <span class="st">"Vector magnitue [g]"</span>, </a>
<a class="sourceLine" id="cb4-10" title="10">       <span class="dt">title =</span> <span class="st">"Vector magnitude (vm) summary of raw accelerometry data"</span>) </a></code></pre></div>
<p><img src="adept-strides-segmentation_files/figure-html/plot_vm-1.png" width="720"></p>
<div id="observations" class="section level5">
<h5 class="hasAnchor">
<a href="#observations" class="anchor"></a>Observations</h5>
<p>From the <span class="math inline">\((x,y,z)\)</span> and <span class="math inline">\((vm)\)</span> plots we can tell the presence of an asymmetric repetitive pattern associated with each walking stride (stride := two subsequent steps):</p>
<ul>
<li>On the <span class="math inline">\((vm)\)</span> plot, the stride beginning and end are marked with a signal magnitude peak corresponding to a moment when the left feet heel hits the ground; between two such peaks, there are one/two smaller peaks, corresponding to the right feet contacting the ground.</li>
</ul>
<p>Also, there are differences in data magnitude and stride duration between the three vertical plot panels:</p>
<ul>
<li><p>The left vertical plot panel (<code>time frame start: 2018-10-25 18:07:00</code>) corresponds to a slow/moderate pace running uphill; <span class="math inline">\((vm)\)</span> time-series exhibits relatively high magnitude.</p></li>
<li><p>The middle vertical plot panel (<code>time frame start: 2018-10-25 18:20:00</code>) corresponds to a relatively fast running; we can observe that <span class="math inline">\((vm)\)</span> time-series exhibits high magnitude. Also, there are more stride patterns captured within this 4-seconds time frame than on the two other 4-seconds time frames, which suggests a higher ratio of strides per second performed by a runner.</p></li>
<li><p>The right vertical plot panel (<code>time frame start: 2018-10-25 18:22:00</code>) most likely corresponds to walking; we can observe relatively low <span class="math inline">\((vm)\)</span> magnitude and a bit different shape of a stride pattern pronounced.</p></li>
</ul>
</div>
</div>
<div id="vector-magnitude-count" class="section level3">
<h3 class="hasAnchor">
<a href="#vector-magnitude-count" class="anchor"></a>Vector magnitude count</h3>
<p>Clearly, it might be challenging to make a plot of <em>all</em> data points collected at frequency 100 Hz from 25 minutes-long exercise. A way to summarize accelerometry data of such high density is to use a <span class="math inline">\((vmc)\)</span> - vector magnitude count (also known as the mean amplitude deviation). For <span class="math inline">\(\overline{vm}(t,H)\)</span> - average of <span class="math inline">\((vm)\)</span> time-series over time window of length <span class="math inline">\(H\)</span> starting at time <span class="math inline">\(t\)</span>, we define <span class="math display">\[\mathrm { vmc } ( t, H ) = \frac { 1 } { H } \sum _ { h = 0 } ^ { H - 1 } \left| vm ( t + h ) - \overline{vm}(t,H) \right|.\]</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co">## Function to compute vmc from a vm window vector</span></a>
<a class="sourceLine" id="cb5-2" title="2">vmc &lt;-<span class="st"> </span><span class="cf">function</span>(vm.win){</a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(vm.win <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(vm.win)))</a>
<a class="sourceLine" id="cb5-4" title="4">}</a>
<a class="sourceLine" id="cb5-5" title="5"></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">## Compute vmc vector in 3-seconds windows </span></a>
<a class="sourceLine" id="cb5-7" title="7">vm &lt;-<span class="st"> </span>acc_running<span class="op">$</span>vm</a>
<a class="sourceLine" id="cb5-8" title="8">win.vl &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb5-9" title="9">rn.seq &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">1</span>, <span class="dt">to =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(vm), <span class="dt">by =</span> win.vl)</a>
<a class="sourceLine" id="cb5-10" title="10">vmc.vec &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(rn.seq, <span class="cf">function</span>(rn.i){</a>
<a class="sourceLine" id="cb5-11" title="11">  vm.win.idx &lt;-<span class="st"> </span>rn.i <span class="op">:</span><span class="st"> </span>(rn.i <span class="op">+</span><span class="st"> </span>win.vl <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-12" title="12">  vm.win &lt;-<span class="st"> </span>vm[vm.win.idx]</a>
<a class="sourceLine" id="cb5-13" title="13">  <span class="kw">vmc</span>(vm.win)</a>
<a class="sourceLine" id="cb5-14" title="14">})</a>
<a class="sourceLine" id="cb5-15" title="15"></a>
<a class="sourceLine" id="cb5-16" title="16">vmc.df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">vmc =</span> vmc.vec,</a>
<a class="sourceLine" id="cb5-17" title="17">                     <span class="dt">date_time =</span> acc_running<span class="op">$</span>date_time[rn.seq],</a>
<a class="sourceLine" id="cb5-18" title="18">                     <span class="dt">rn_seq =</span> rn.seq,</a>
<a class="sourceLine" id="cb5-19" title="19">                     <span class="dt">sensor_location =</span> acc_running<span class="op">$</span>sensor_location[rn.seq]) </a>
<a class="sourceLine" id="cb5-20" title="20">vmc.df.rest &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="st">  </span>vmc.df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(sensor_location <span class="op">==</span><span class="st"> "left_ankle"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-23" title="23"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">resting =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ifelse">ifelse</a></span>(vmc <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb5-24" title="24">         <span class="dt">vmc_tau_i =</span> rn_seq <span class="op">-</span><span class="st"> </span><span class="dv">150000</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-25" title="25"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(date_time, resting, vmc_tau_i)</a>
<a class="sourceLine" id="cb5-26" title="26">vmc.df &lt;-<span class="st"> </span>vmc.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(vmc.df.rest, <span class="dt">by =</span> <span class="st">"date_time"</span>)</a>
<a class="sourceLine" id="cb5-27" title="27"></a>
<a class="sourceLine" id="cb5-28" title="28"><span class="co">## Plot vmc </span></a>
<a class="sourceLine" id="cb5-29" title="29">vmc.df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-30" title="30"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(date_time <span class="op">&lt;</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(acc_running<span class="op">$</span>date_time) <span class="op">-</span><span class="st"> </span><span class="dv">5</span>, </a>
<a class="sourceLine" id="cb5-31" title="31">         date_time <span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(acc_running<span class="op">$</span>date_time) <span class="op">+</span><span class="st"> </span><span class="dv">5</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-32" title="32"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> date_time, <span class="dt">y =</span> vmc)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-33" title="33"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/facet_grid">facet_grid</a></span>(sensor_location <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-34" title="34"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_tile">geom_tile</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">fill =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(resting)),  <span class="dt">height =</span> <span class="ot">Inf</span>, <span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-35" title="35"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-36" title="36"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-37" title="37"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"Exercise time [min]"</span>, <span class="dt">y =</span> <span class="st">"Vector magnitue count"</span>,</a>
<a class="sourceLine" id="cb5-38" title="38">       <span class="dt">title =</span> <span class="st">"Vector magnitude count (vmc) computed over 3 second-length windows of (vm)"</span>,</a>
<a class="sourceLine" id="cb5-39" title="39">       <span class="dt">fill =</span> <span class="st">"Resting: "</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-40" title="40"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/scale_manual">scale_fill_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"white"</span>, <span class="st">"blue"</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-41" title="41"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"top"</span>,</a>
<a class="sourceLine" id="cb5-42" title="42">        <span class="dt">legend.background =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/element">element_rect</a></span>(<span class="dt">fill =</span> <span class="st">"grey90"</span>))</a></code></pre></div>
<p><img src="adept-strides-segmentation_files/figure-html/plot_vmc-1.png" width="720"></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co">## Time percentage when (vmc) computed from left ankle is below 0.4</span></a>
<a class="sourceLine" id="cb6-2" title="2">(vmc.low.frac &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(vmc.df.rest<span class="op">$</span>resting))</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#&gt; [1] 0.186</span></a></code></pre></div>
<div id="observations-1" class="section level5">
<h5 class="hasAnchor">
<a href="#observations-1" class="anchor"></a>Observations</h5>
<ul>
<li><p>We see that approx. 19% of the time <span class="math inline">\((vmc)\)</span> computed from left ankle data is below 0.4 value. Here, that part of data <em>likely</em> corresponds to standing with no walking/running legs movement involved; it may be that the runner was waiting on the crossroad for a green light to cross, or was being tired and hence was making breaks. We use this arbitrarily selected threshold of 0.4 to partition data into time frames of resting (<span class="math inline">\((vmc)&lt;0.4\)</span>; marked with light blue color) and non-resting (<span class="math inline">\((vmc)\geq 0.4\)</span>).</p></li>
<li><p>On the contrary, high values of <span class="math inline">\((vmc)\)</span> correspond to high volumes of physical activity recorded; in this experiment, at approx. 18:21 (6:21 PM) a short (~1 minute) period of a fast run started, corresponding to particularly high values of <span class="math inline">\((vmc)\)</span> recorded with both left ankle and left hip sensors.</p></li>
</ul>
</div>
</div>
</div>
<div id="walking-strides-segmentation" class="section level1">
<h1 class="hasAnchor">
<a href="#walking-strides-segmentation" class="anchor"></a>Walking strides segmentation</h1>
<p>To perform strides segmentation from <span class="math inline">\((vm)\)</span> time-series, we need a stride pattern template that is specific to a sensor location that data were collected at. We are going to demonstrate two approaches:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Approach 1</strong>: Use stride pattern templates attached to the <code>adept</code> package as <code>stride_template</code> object. These walking strides were derived from a set of manually pre-segmented strides from data collected in a different experiment, with different participants (see <code><a href="../reference/stride_template.html">?stride_template</a></code> for details).</p></li>
<li><p><strong>Approach 2</strong>: Derive stride pattern templates manually from <code>acc_running</code> data set.</p></li>
</ol>
<div id="smoothing-parameter-selection" class="section level3">
<h3 class="hasAnchor">
<a href="#smoothing-parameter-selection" class="anchor"></a>Smoothing parameter selection</h3>
<p>The <code>segmentPattern</code> function algorithm has two phases in which a smoothed version of <span class="math inline">\((vm)\)</span> time-series may be used:</p>
<ol style="list-style-type: decimal">
<li>
<p>In computation of similarity matrix between pattern template and (possibly smoothed) <span class="math inline">\((vm)\)</span> signal. Here, <code>x.adept.ma.W</code> argument of <code>segmentPattern</code> function defines a length of a window used in moving average smoothing; it is expressed in seconds.</p>
<p>For this phase, we recommend low/moderate smoothing (<code>x.adept.ma.W = 0.05</code>, <code>x.adept.ma.W = 0.15</code>) so as tiny <span class="math inline">\((vm)\)</span> bumps are smoothed, but the overall <span class="math inline">\((vm)\)</span> shape features are not lost.</p>
</li>
<li>
<p>In “maxima” tuning procedure where local maxima of (possibly smoothed) <span class="math inline">\((vm)\)</span> signal are identified as final beginnings and ends of a stride pattern occurrence. Here, <code>finetune.maxima.ma.W</code> argument of <code>segmentPattern</code> function defines a length of a window used in moving average smoothing; it is expressed in seconds.</p>
<p>For this phase, in case of a very clear signal and distinct signal local maxima, no smoothing may be used (<code>finetune.maxima.ma.W = NULL</code>); in case of low-signal and noisy data (i.e., often the case of data collected with a sensor located at wrist), high levels of smoothing (<code>finetune.maxima.ma.W = 0.3</code> or similar) may be used.</p>
</li>
</ol>
<p>Function <code>windowSmooth {adept}</code> computes moving window average of a time-series <code>x</code> and may be used to experiment with different values of smoothing window length <code>W</code> (expressed in seconds). Results of the exemplary choice of smoothing parameter <code>W</code> are presented below.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co">## Use moving window average with a length of a window equal 0.05 s </span></a>
<a class="sourceLine" id="cb7-2" title="2">acc_running<span class="op">$</span>vm_smoothed1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/windowSmooth.html">windowSmooth</a></span>(<span class="dt">x =</span> acc_running<span class="op">$</span>vm, <span class="dt">x.fs =</span> <span class="dv">100</span>, <span class="dt">W =</span> <span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb7-3" title="3"></a>
<a class="sourceLine" id="cb7-4" title="4">acc_running <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>((date_time <span class="op">&gt;=</span><span class="st"> </span>t1 <span class="op">&amp;</span><span class="st"> </span>date_time <span class="op">&lt;</span><span class="st"> </span>t1 <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/as.period.html">as.period</a></span>(<span class="dv">4</span>, <span class="st">"seconds"</span>)) <span class="op">|</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="st">           </span>(date_time <span class="op">&gt;=</span><span class="st"> </span>t2 <span class="op">&amp;</span><span class="st"> </span>date_time <span class="op">&lt;</span><span class="st"> </span>t2 <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/as.period.html">as.period</a></span>(<span class="dv">4</span>, <span class="st">"seconds"</span>)) <span class="op">|</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="st">           </span>(date_time <span class="op">&gt;=</span><span class="st"> </span>t3 <span class="op">&amp;</span><span class="st"> </span>date_time <span class="op">&lt;</span><span class="st"> </span>t3 <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/as.period.html">as.period</a></span>(<span class="dv">4</span>, <span class="st">"seconds"</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">dt_floor =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"time frame start: "</span>, </a>
<a class="sourceLine" id="cb7-9" title="9">                           <span class="kw"><a href="http://lubridate.tidyverse.org/reference/round_date.html">floor_date</a></span>(date_time, <span class="dt">unit =</span> <span class="st">"minutes"</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> date_time, <span class="dt">y =</span> vm_smoothed1)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">size =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/facet_grid">facet_grid</a></span>(sensor_location <span class="op">~</span><span class="st"> </span>dt_floor, <span class="dt">scales =</span> <span class="st">"free_x"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"Time [s]"</span>, <span class="dt">y =</span> <span class="st">"Vector magnitue [g]"</span>, <span class="dt">color =</span> <span class="st">"Axis: "</span>,</a>
<a class="sourceLine" id="cb7-15" title="15">       <span class="dt">title =</span> <span class="st">"Vector magnitude (vm) smoothed, length of smoothing window = 0.05 s"</span>) </a></code></pre></div>
<p><img src="adept-strides-segmentation_files/figure-html/plot_vm_smoothed2-1.png" width="672"></p>
</div>
<div id="segmentation-with-approach-1-use-existing-stride-pattern-templates" class="section level3">
<h3 class="hasAnchor">
<a href="#segmentation-with-approach-1-use-existing-stride-pattern-templates" class="anchor"></a>Segmentation with <em>Approach 1</em>: use existing stride pattern templates</h3>
<div id="left-ankle" class="section level5">
<h5 class="hasAnchor">
<a href="#left-ankle" class="anchor"></a>Left ankle</h5>
<p>We first construct a <code>template</code> object; it is a list of left ankle-specific stride templates (due to movement symmetry, it could serve for right ankle same well!). Here, we use two precomputed templates (see <code><a href="../reference/stride_template.html">?stride_template</a></code> for details).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">template &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(stride_template<span class="op">$</span>left_ankle[[<span class="dv">2</span>]][<span class="dv">1</span>, ],</a>
<a class="sourceLine" id="cb8-2" title="2">                 stride_template<span class="op">$</span>left_ankle[[<span class="dv">2</span>]][<span class="dv">2</span>, ])</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb8-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(template[[<span class="dv">1</span>]], <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">""</span>, <span class="dt">ylab =</span> <span class="st">""</span>, <span class="dt">main =</span> <span class="st">"Left ankle: template 1"</span>)</a>
<a class="sourceLine" id="cb8-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(template[[<span class="dv">2</span>]], <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">""</span>, <span class="dt">ylab =</span> <span class="st">""</span>, <span class="dt">main =</span> <span class="st">"Left ankle: template 2"</span>)</a></code></pre></div>
<p><img src="adept-strides-segmentation_files/figure-html/segm_la-1.png" width="576"></p>
<p>We perform strides segmentation from <span class="math inline">\((vm)\)</span> accelerometry signal. Explanation of some of parameters used:</p>
<ul>
<li>
<code>x</code> - A <span class="math inline">\((vm)\)</span> vector we segment pattern occurrences from.</li>
<li>
<code>x.fs</code> - Frequency at which data is collected, expressed in a number of observations per second.</li>
<li>
<code>template</code> - A list of pattern templates.</li>
<li>
<code>pattern.dur.seq</code> - A grid of template scales considered in segmentation. Grid values are expressed in seconds of pattern duration time; their range is determined by what we consider plausible duration time for a pattern to take. In case of healthy adult person, 0.5-1.8 seconds range for a stride (:= two subsequent steps) seems reasonable; for data collected in elderly population, 0.5-2.25 seconds could be considered etc. (See: <code>Details</code> in <code><a href="../reference/segmentPattern.html">?segmentPattern</a></code>).</li>
<li>
<code>finetune</code> - If set to <code>"maxima"</code>, a procedure is employed to tune preliminarily identified locations of pattern occurrence beginning and end so as they correspond to local maxima of <span class="math inline">\((vm)\)</span>.</li>
<li>
<code>run.parallel</code> - Whether or not to use parallel execution in the algorithm. The <code>future</code> package is used to execute code asynchronously.</li>
</ul>
<p>See <code><a href="../reference/segmentPattern.html">?segmentPattern</a></code> for detailed explanation of all method parameters.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># ```{r segm_la2, eval = FALSE}</span></a>
<a class="sourceLine" id="cb9-2" title="2">x.la &lt;-<span class="st"> </span>acc_running<span class="op">$</span>vm[acc_running<span class="op">$</span>sensor_location <span class="op">==</span><span class="st"> "left_ankle"</span>]</a>
<a class="sourceLine" id="cb9-3" title="3">out1.la &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x.la,</a>
<a class="sourceLine" id="cb9-4" title="4">                          <span class="dt">x.fs =</span> <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb9-5" title="5">                          <span class="dt">template =</span> template,</a>
<a class="sourceLine" id="cb9-6" title="6">                          <span class="dt">pattern.dur.seq =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="fl">0.5</span>, <span class="fl">1.8</span>, <span class="dt">length.out =</span> <span class="dv">50</span>),</a>
<a class="sourceLine" id="cb9-7" title="7">                          <span class="dt">similarity.measure =</span> <span class="st">"cor"</span>,</a>
<a class="sourceLine" id="cb9-8" title="8">                          <span class="dt">x.adept.ma.W =</span> <span class="fl">0.15</span>,</a>
<a class="sourceLine" id="cb9-9" title="9">                          <span class="dt">finetune =</span> <span class="st">"maxima"</span>,</a>
<a class="sourceLine" id="cb9-10" title="10">                          <span class="dt">finetune.maxima.ma.W =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb9-11" title="11">                          <span class="dt">finetune.maxima.nbh.W =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb9-12" title="12">                          <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb9-13" title="13">                          <span class="dt">run.parallel =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(out1.la)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">#&gt;   tau_i T_i        sim_i template_i</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#&gt; 1     4  59 4.300014e-08          1</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">#&gt; 2    62  55 4.060947e-08          1</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#&gt; 3   142 115 7.533280e-01          1</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt; 4   256  76 8.841799e-01          1</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt; 5   371  81 9.152038e-01          1</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt; 6   451  78 9.075649e-01          1</span></a></code></pre></div>
<p>Each row of the returned <code>data.frame</code> describes one identified pattern occurrence:</p>
<ul>
<li>
<code>tau_i</code> -Index of a vector (here: <span class="math inline">\((vm)\)</span> time-series) where an identified pattern occurrence starts.</li>
<li>
<code>T_i</code> - Duration of identified pattern occurrence, expressed in a vector length.</li>
<li>
<code>sim_i</code> - Value of similarity statistic between pattern template and a data signal (here: <span class="math inline">\((vm)\)</span> time-series) where the pattern occurrence was identified (see <code><a href="../reference/segmentPattern.html">?segmentPattern</a></code> for details).</li>
<li>
<code>template_i</code> - If <code>compute.template.idx</code> equals <code>TRUE</code>: index of pattern template that had the best match with a data signal where the pattern occurrence was identified; otherwise: <code>NA</code>.</li>
</ul>
<p>We now run segmentation on data collected at left hip. We then compare the results.</p>
</div>
<div id="left-hip" class="section level5">
<h5 class="hasAnchor">
<a href="#left-hip" class="anchor"></a>Left hip</h5>
<p>Construct <code>template</code> object; it is a list of left hip-specific stride templates (again: due to movement symmetry, it could serve for right ankle same well!).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">template &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(stride_template<span class="op">$</span>left_hip[[<span class="dv">1</span>]][<span class="dv">1</span>, ],</a>
<a class="sourceLine" id="cb11-2" title="2">                 stride_template<span class="op">$</span>left_hip[[<span class="dv">2</span>]][<span class="dv">2</span>, ])</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb11-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(template[[<span class="dv">1</span>]], <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">""</span>, <span class="dt">ylab =</span> <span class="st">""</span>, <span class="dt">main =</span> <span class="st">"Left hip: template 1"</span>)</a>
<a class="sourceLine" id="cb11-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(template[[<span class="dv">2</span>]], <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">xlab =</span> <span class="st">""</span>, <span class="dt">ylab =</span> <span class="st">""</span>, <span class="dt">main =</span> <span class="st">"Left hip: template 2"</span>)</a></code></pre></div>
<p><img src="adept-strides-segmentation_files/figure-html/segm_lh-1.png" width="576"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">template &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(stride_template<span class="op">$</span>left_hip[[<span class="dv">1</span>]][<span class="dv">1</span>, ],</a>
<a class="sourceLine" id="cb12-2" title="2">                 stride_template<span class="op">$</span>left_hip[[<span class="dv">2</span>]][<span class="dv">2</span>, ])</a>
<a class="sourceLine" id="cb12-3" title="3">x.lh &lt;-<span class="st"> </span>acc_running<span class="op">$</span>vm[acc_running<span class="op">$</span>sensor_location <span class="op">==</span><span class="st"> "left_hip"</span>]</a>
<a class="sourceLine" id="cb12-4" title="4">out1.lh &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x.lh,</a>
<a class="sourceLine" id="cb12-5" title="5">                          <span class="dt">x.fs =</span> <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb12-6" title="6">                          <span class="dt">template =</span> template,</a>
<a class="sourceLine" id="cb12-7" title="7">                          <span class="dt">pattern.dur.seq =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="fl">0.5</span>, <span class="fl">1.8</span>, <span class="dt">length.out =</span> <span class="dv">50</span>),</a>
<a class="sourceLine" id="cb12-8" title="8">                          <span class="dt">similarity.measure =</span> <span class="st">"cor"</span>,</a>
<a class="sourceLine" id="cb12-9" title="9">                          <span class="dt">x.adept.ma.W =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb12-10" title="10">                          <span class="dt">finetune =</span> <span class="st">"maxima"</span>,</a>
<a class="sourceLine" id="cb12-11" title="11">                          <span class="dt">finetune.maxima.ma.W =</span> <span class="fl">0.15</span>,</a>
<a class="sourceLine" id="cb12-12" title="12">                          <span class="dt">finetune.maxima.nbh.W =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb12-13" title="13">                          <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb12-14" title="14">                          <span class="dt">run.parallel =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(out1.lh)</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co">#&gt;   tau_i T_i     sim_i template_i</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="co">#&gt; 1     8  52 0.7124452          2</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">#&gt; 2    59  54 0.8113169          2</span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="co">#&gt; 3   156 126 0.8446630          1</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co">#&gt; 4   301  70 0.6299608          1</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co">#&gt; 5   370  82 0.8684391          1</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="co">#&gt; 6   451  79 0.8231402          1</span></a></code></pre></div>
</div>
<div id="results-estimated-stride-duration-time" class="section level4">
<h4 class="hasAnchor">
<a href="#results-estimated-stride-duration-time" class="anchor"></a>Results: estimated stride duration time</h4>
<p>We now plot estimated stride duration in seconds (<code>T_i</code>/100) against estimated stride start in minutes (<code>tau_i</code>/(100<em>60)). We firstly filter the results so as to keep only those which are </em>likely* corresponding to walking/running (not: resting). We also mark estimated resting/not-resting labels for subsequent 3-minute time windows which we obtained from <span class="math inline">\((vmc)\)</span> data.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co">## Merge results from two sensor locations, add resting/non-resting info</span></a>
<a class="sourceLine" id="cb14-2" title="2">plt.df.la &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="st">  </span>out1.la <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/merge">merge</a></span>(vmc.df.rest) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(tau_i <span class="op">&gt;=</span><span class="st"> </span>vmc_tau_i, tau_i <span class="op">&lt;</span><span class="st"> </span>vmc_tau_i <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, resting <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">location =</span> <span class="st">"left_ankle"</span>)</a>
<a class="sourceLine" id="cb14-7" title="7">plt.df.lh &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="st">  </span>out1.lh <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-9" title="9"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/merge">merge</a></span>(vmc.df.rest) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(tau_i <span class="op">&gt;=</span><span class="st"> </span>vmc_tau_i, tau_i <span class="op">&lt;</span><span class="st"> </span>vmc_tau_i <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, resting <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-11" title="11"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">location =</span> <span class="st">"left_hip"</span>)</a>
<a class="sourceLine" id="cb14-12" title="12">plt.df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(plt.df.la, plt.df.lh)</a>
<a class="sourceLine" id="cb14-13" title="13"></a>
<a class="sourceLine" id="cb14-14" title="14"><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(plt.df,</a>
<a class="sourceLine" id="cb14-15" title="15">    <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> tau_i <span class="op">/</span><span class="st"> </span>(<span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="dv">60</span>) , <span class="dt">y =</span> T_i <span class="op">/</span><span class="st"> </span><span class="dv">100</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-16" title="16"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_tile">geom_tile</a></span>(<span class="dt">data =</span> vmc.df.rest, </a>
<a class="sourceLine" id="cb14-17" title="17">            <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> vmc_tau_i <span class="op">/</span><span class="st"> </span>(<span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="dv">60</span>), <span class="dt">y =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(resting)), </a>
<a class="sourceLine" id="cb14-18" title="18">            <span class="dt">height =</span> <span class="ot">Inf</span>, <span class="dt">alpha =</span> <span class="fl">0.1</span>, <span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-19" title="19"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-20" title="20"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/facet_grid">facet_grid</a></span>(location <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-21" title="21"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-22" title="22"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"Exercise time [min]"</span>, <span class="dt">y =</span> <span class="st">"Estimated stride duration time [s]"</span>,</a>
<a class="sourceLine" id="cb14-23" title="23">       <span class="dt">fill =</span> <span class="st">"Resting: "</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-24" title="24"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"top"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-25" title="25"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/scale_manual">scale_fill_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"white"</span>, <span class="st">"blue"</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-26" title="26"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"top"</span>,</a>
<a class="sourceLine" id="cb14-27" title="27">        <span class="dt">legend.background =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/element">element_rect</a></span>(<span class="dt">fill =</span> <span class="st">"grey90"</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-28" title="28"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/scale_continuous">scale_y_continuous</a></span>(<span class="dt">limits =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.5</span>, <span class="fl">1.8</span>))</a></code></pre></div>
<p><img src="adept-strides-segmentation_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<div id="observations-2" class="section level5">
<h5 class="hasAnchor">
<a href="#observations-2" class="anchor"></a>Observations</h5>
<ul>
<li>We observe the estimated stride duration (y-axis) is mostly consistent between the left ankle and left hip data. The small differences we observe between them may result from different <span class="math inline">\((vm)\)</span> smoothing parameters used in tuning procedure for strides beginning and end (left ankle: <code>finetune.maxima.ma.W = 0.05</code>, left hip: <code>finetune.maxima.ma.W = 0.15</code>).</li>
<li>Intuitively, it makes sense that around the resting periods (light blue shade), we observe strides of longer duration (the runner may be slowing down), or a short duration (the runner may be making short steps) before stopping etc.</li>
</ul>
</div>
</div>
<div id="results-subject-specific-stride-pattern-left-ankle" class="section level4">
<h4 class="hasAnchor">
<a href="#results-subject-specific-stride-pattern-left-ankle" class="anchor"></a>Results: subject-specific stride pattern (left ankle)</h4>
<p>We now use the estimated stride occurrence start index (<code>tau_i</code>) and estimated stride duration (<code>T_i</code>) to retrieve <span class="math inline">\((vm)\)</span> time-series segments corresponding to stride occurrences. We further align them in phase and scale to better observe stride patterns.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co">## For data frame #1 (raw vm segments)</span></a>
<a class="sourceLine" id="cb15-2" title="2">stride.acc.vec.la &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">numeric</a></span>()</a>
<a class="sourceLine" id="cb15-3" title="3">stride.tau_i.vec.la &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">numeric</a></span>()</a>
<a class="sourceLine" id="cb15-4" title="4">stride.idx.vec.la &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">numeric</a></span>()</a>
<a class="sourceLine" id="cb15-5" title="5"><span class="co">## For data frame #2 (scaled vm segments)</span></a>
<a class="sourceLine" id="cb15-6" title="6">stride_S.acc.vec.la &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">numeric</a></span>()</a>
<a class="sourceLine" id="cb15-7" title="7">stride_S.tau_i.vec.la &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">numeric</a></span>()</a>
<a class="sourceLine" id="cb15-8" title="8">stride_S.phase.vec.la &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">numeric</a></span>()</a>
<a class="sourceLine" id="cb15-9" title="9"></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(plt.df.la)){</a>
<a class="sourceLine" id="cb15-11" title="11">  out.i &lt;-<span class="st"> </span>plt.df.la[i, ]</a>
<a class="sourceLine" id="cb15-12" title="12">  x.la.i &lt;-<span class="st"> </span>x.la[out.i<span class="op">$</span>tau_i <span class="op">:</span><span class="st"> </span>(out.i<span class="op">$</span>tau_i <span class="op">+</span><span class="st"> </span>out.i<span class="op">$</span>T_i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)]</a>
<a class="sourceLine" id="cb15-13" title="13">  x.la.i.len &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x.la.i)</a>
<a class="sourceLine" id="cb15-14" title="14">  <span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">var</a></span>(x.la.i) <span class="op">&lt;</span><span class="st"> </span><span class="fl">1e-3</span>) <span class="cf">next</span></a>
<a class="sourceLine" id="cb15-15" title="15">  <span class="co">## For data frame #1 </span></a>
<a class="sourceLine" id="cb15-16" title="16">  stride.acc.vec.la   &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(stride.acc.vec.la, x.la.i)</a>
<a class="sourceLine" id="cb15-17" title="17">  stride.tau_i.vec.la &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(stride.tau_i.vec.la, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(out.i<span class="op">$</span>tau_i, x.la.i.len))</a>
<a class="sourceLine" id="cb15-18" title="18">  stride.idx.vec.la &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(stride.idx.vec.la, <span class="dv">1</span><span class="op">:</span>x.la.i.len)</a>
<a class="sourceLine" id="cb15-19" title="19">  <span class="co">## For data frame #2</span></a>
<a class="sourceLine" id="cb15-20" title="20">  x.la.i_S &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/approxfun">approx</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x.la.i)),</a>
<a class="sourceLine" id="cb15-21" title="21">                     <span class="dt">y =</span> x.la.i,</a>
<a class="sourceLine" id="cb15-22" title="22">                     <span class="dt">xout =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">200</span>))<span class="op">$</span>y</a>
<a class="sourceLine" id="cb15-23" title="23">  x.la.i_S &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/scale">scale</a></span>(x.la.i_S))</a>
<a class="sourceLine" id="cb15-24" title="24">  stride_S.acc.vec.la &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(stride_S.acc.vec.la, x.la.i_S)</a>
<a class="sourceLine" id="cb15-25" title="25">  stride_S.tau_i.vec.la &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(stride_S.tau_i.vec.la, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(out.i<span class="op">$</span>tau_i, <span class="dv">200</span>))</a>
<a class="sourceLine" id="cb15-26" title="26">  stride_S.phase.vec.la &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(stride_S.phase.vec.la, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">200</span>))</a>
<a class="sourceLine" id="cb15-27" title="27">}</a>
<a class="sourceLine" id="cb15-28" title="28"></a>
<a class="sourceLine" id="cb15-29" title="29"><span class="co">## data frame #1 </span></a>
<a class="sourceLine" id="cb15-30" title="30">stride.df.la &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">acc =</span> stride.acc.vec.la, </a>
<a class="sourceLine" id="cb15-31" title="31">                           <span class="dt">tau_i =</span> stride.tau_i.vec.la,</a>
<a class="sourceLine" id="cb15-32" title="32">                           <span class="dt">idx =</span> stride.idx.vec.la)</a>
<a class="sourceLine" id="cb15-33" title="33"><span class="co">## data frame #2</span></a>
<a class="sourceLine" id="cb15-34" title="34">stride_S.df.la &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">acc =</span> stride_S.acc.vec.la, </a>
<a class="sourceLine" id="cb15-35" title="35">                             <span class="dt">tau_i =</span> stride_S.tau_i.vec.la,</a>
<a class="sourceLine" id="cb15-36" title="36">                             <span class="dt">phase =</span> stride_S.phase.vec.la)</a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co">## Plot segmented walking strides</span></a>
<a class="sourceLine" id="cb16-2" title="2">plt1 &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="st">  </span>stride.df.la <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> idx<span class="op">/</span><span class="dv">100</span>, <span class="dt">y =</span> acc, <span class="dt">group =</span> tau_i)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">8</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"Stride pattern duration [s]"</span>, <span class="dt">y =</span> <span class="st">"Vector magnitude [g]"</span>,</a>
<a class="sourceLine" id="cb16-8" title="8">       <span class="dt">title =</span> <span class="st">"Segmented walking strides"</span>)</a>
<a class="sourceLine" id="cb16-9" title="9">plt2 &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="st">  </span>stride_S.df.la <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> phase, <span class="dt">y =</span> acc, <span class="dt">group =</span> tau_i)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-13" title="13"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">8</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-14" title="14"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"Stride pattern phase"</span>, <span class="dt">y =</span> <span class="st">"Vector magnitude (scaled) [g]"</span>,</a>
<a class="sourceLine" id="cb16-15" title="15">       <span class="dt">title =</span> <span class="st">"Segmented walking strides, aligned and scaled"</span>) </a>
<a class="sourceLine" id="cb16-16" title="16"><span class="kw"><a href="https://www.rdocumentation.org/packages/gridExtra/topics/arrangeGrob">grid.arrange</a></span>(plt1, plt2, <span class="dt">nrow =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="adept-strides-segmentation_files/figure-html/plot_subject_specific_sp-1.png" width="672"></p>
<ul>
<li>From the plot of aligned and scaled strides (right hand side above), it seems there are at least two distinct stride patterns pronounced in data - one with a “spike with a dip” in a middle of a stride pattern phase, and another, less frequent (fewer lines on the plot), with a spike at approx. 2/3 of a stride pattern phase.</li>
</ul>
<div id="correlation-clustering-of-segmented-walking-strides" class="section level5">
<h5 class="hasAnchor">
<a href="#correlation-clustering-of-segmented-walking-strides" class="anchor"></a>Correlation clustering of segmented walking strides</h5>
<p>We can further use correlation clustering to group segmented walking strides.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co">## Compute strides distance martrix</span></a>
<a class="sourceLine" id="cb17-2" title="2">stride_S.dfdc.la &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/reshape2/topics/cast">dcast</a></span>(stride_S.df.la, phase <span class="op">~</span><span class="st"> </span>tau_i, <span class="dt">value.var =</span> <span class="st">"acc"</span>)[, <span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb17-3" title="3">data.mat.tau_i &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(stride_S.dfdc.la))</a>
<a class="sourceLine" id="cb17-4" title="4">data.mat &lt;-<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">as.matrix</a></span>(stride_S.dfdc.la)</a>
<a class="sourceLine" id="cb17-5" title="5">D.mat  &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/dist">dist</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(data.mat))</a>
<a class="sourceLine" id="cb17-6" title="6"></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">## Get cluster medoids</span></a>
<a class="sourceLine" id="cb17-8" title="8">cluster.k &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb17-9" title="9">medoids.idx &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">1</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(stride_S.dfdc.la), <span class="dt">length.out =</span> cluster.k <span class="op">+</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb17-10" title="10">medoids.idx &lt;-<span class="st"> </span>medoids.idx[<span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, medoids.idx <span class="op">+</span><span class="st"> </span><span class="dv">2</span>)]</a>
<a class="sourceLine" id="cb17-11" title="11"></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="co">## Cluster strides</span></a>
<a class="sourceLine" id="cb17-13" title="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-14" title="14">pam.out &lt;-<span class="st"> </span>cluster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/cluster/topics/pam">pam</a></span>(D.mat, cluster.k, <span class="dt">diss =</span> <span class="ot">TRUE</span>, <span class="dt">medoids =</span> medoids.idx)</a>
<a class="sourceLine" id="cb17-15" title="15"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/table">table</a></span>(pam.out<span class="op">$</span>clustering)</a>
<a class="sourceLine" id="cb17-16" title="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb17-17" title="17"><span class="co">#&gt;    1    2 </span></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="co">#&gt; 1419  120</span></a>
<a class="sourceLine" id="cb17-19" title="19"></a>
<a class="sourceLine" id="cb17-20" title="20"><span class="co">## Put clustering results into data frame </span></a>
<a class="sourceLine" id="cb17-21" title="21">data.df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(data.mat))</a>
<a class="sourceLine" id="cb17-22" title="22"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(data.df) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">200</span>)</a>
<a class="sourceLine" id="cb17-23" title="23">data.df<span class="op">$</span>tau_i &lt;-<span class="st"> </span>data.mat.tau_i</a>
<a class="sourceLine" id="cb17-24" title="24">data.df<span class="op">$</span>cluster &lt;-<span class="st"> </span>pam.out<span class="op">$</span>clustering</a>
<a class="sourceLine" id="cb17-25" title="25">data.dfm &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/reshape2/topics/melt">melt</a></span>(data.df, <span class="dt">id.vars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"tau_i"</span>, <span class="st">"cluster"</span>))</a>
<a class="sourceLine" id="cb17-26" title="26">data.dfm<span class="op">$</span>variable &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(data.dfm<span class="op">$</span>variable))</a>
<a class="sourceLine" id="cb17-27" title="27">data.dfm<span class="op">$</span>cluster &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"cluster "</span>, data.dfm<span class="op">$</span>cluster)</a></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">data.dfm.agg &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="st">  </span>data.dfm <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(variable, cluster) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="dt">value =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(value))</a>
<a class="sourceLine" id="cb18-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(data.dfm, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> variable, <span class="dt">y =</span> value, <span class="dt">group =</span> tau_i)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">data =</span> data.dfm.agg,  <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> variable, <span class="dt">y =</span> value, <span class="dt">group =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb18-8" title="8">            <span class="dt">color =</span> <span class="st">"red"</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/facet_grid">facet_grid</a></span>(cluster <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"Stride pattern phase"</span>, <span class="dt">y =</span> <span class="st">"Vector magnitude (scaled) [g]"</span>,</a>
<a class="sourceLine" id="cb18-12" title="12">       <span class="dt">title =</span> <span class="st">"Segmented walking strides, aligned, scaled, clustered</span><span class="ch">\n</span><span class="st">Red line: point-wise mean"</span>) </a></code></pre></div>
<p><img src="adept-strides-segmentation_files/figure-html/plot_correlation_clustering-1.png" width="384"></p>
<p>We can further plot the estimated stride duration time over the course of the running exercise, marking the stride pattern cluster assignment with colour.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">data.dfm <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(tau_i, cluster)  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(plt.df.la, <span class="dt">by =</span> <span class="st">"tau_i"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> tau_i <span class="op">/</span><span class="st"> </span>(<span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="dv">60</span>) , <span class="dt">y =</span> T_i <span class="op">/</span><span class="st"> </span><span class="dv">100</span>, <span class="dt">color =</span> cluster)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_tile">geom_tile</a></span>(<span class="dt">data =</span> vmc.df.rest, </a>
<a class="sourceLine" id="cb19-7" title="7">            <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> vmc_tau_i <span class="op">/</span><span class="st"> </span>(<span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="dv">60</span>), <span class="dt">y =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(resting)), </a>
<a class="sourceLine" id="cb19-8" title="8">            <span class="dt">height =</span> <span class="ot">Inf</span>, <span class="dt">alpha =</span> <span class="fl">0.1</span>, <span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-9" title="9"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>(<span class="dt">alpha =</span> <span class="fl">0.4</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-10" title="10"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"Exercise time [min]"</span>, <span class="dt">y =</span> <span class="st">"Estimated stride duration time [s]"</span>,</a>
<a class="sourceLine" id="cb19-12" title="12">       <span class="dt">color =</span> <span class="st">"Stride assignment: "</span>,</a>
<a class="sourceLine" id="cb19-13" title="13">       <span class="dt">fill =</span> <span class="st">"Resting: "</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-14" title="14"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/scale_manual">scale_fill_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"white"</span>, <span class="st">"blue"</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-15" title="15"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"top"</span>,</a>
<a class="sourceLine" id="cb19-16" title="16">        <span class="dt">legend.background =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/element">element_rect</a></span>(<span class="dt">fill =</span> <span class="st">"grey90"</span>))  <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-17" title="17"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/scale_continuous">scale_y_continuous</a></span>(<span class="dt">limits =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.5</span>, <span class="fl">1.8</span>))</a></code></pre></div>
<p><img src="adept-strides-segmentation_files/figure-html/correlation_clustering_2-1.png" width="672"></p>
</div>
<div id="observations-3" class="section level5">
<h5 class="hasAnchor">
<a href="#observations-3" class="anchor"></a>Observations</h5>
<ul>
<li>From the plot above we can note that stride pattern cluster assignment somehow corresponds to performed activity: strides marked with red <em>likely</em> correspond to running, strides marked with green - walking.</li>
</ul>
</div>
</div>
</div>
<div id="segmentation-with-approach-2-derive-stride-pattern-templates-manually" class="section level3">
<h3 class="hasAnchor">
<a href="#segmentation-with-approach-2-derive-stride-pattern-templates-manually" class="anchor"></a>Segmentation with <em>Approach 2</em>: derive stride pattern templates manually</h3>
<p>We now demonstrate a way of deriving stride patterns from data in a semi-manual way. The proposed procedure is done separately for data collected at two different locations, and goes as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Select short fragments of <span class="math inline">\((vm)\)</span> time-series that are likely to represent data coming from different pace of running/walking. Here, we select two such <span class="math inline">\((vm)\)</span> fragments, each of 6 seconds length.</p></li>
<li><p>Within each of three <span class="math inline">\((vm)\)</span> fragments, use a function to automatically identify <em>all</em> local maxima.</p></li>
<li><p>Within each of three <span class="math inline">\((vm)\)</span> fragments, identify a <em>subset</em> of local maxima that corresponds to <span class="math inline">\((vm)\)</span> peaks of interest via visual inspection (“manual” part).</p></li>
<li><p>For each of three <span class="math inline">\((vm)\)</span> fragments, cut the <span class="math inline">\((vm)\)</span> fragment into parts at the points of identified local maxima subset. Interpolate parts to common a length and compute their point-wise average. The resulted point-wise average is a newly created pattern template.</p></li>
</ol>
<p>That way, for each sensor location, we arrive at three distinct stride pattern templates that we further use in segmentation.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="co">## Function to compute local maxima</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="co">## source: https://stackoverflow.com/questions/6836409/finding-local-maxima-and-minima</span></a>
<a class="sourceLine" id="cb20-3" title="3">localMaxima &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb20-4" title="4">  y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/diff">diff</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span>.Machine<span class="op">$</span>integer.max, x)) <span class="op">&gt;</span><span class="st"> </span>0L</a>
<a class="sourceLine" id="cb20-5" title="5">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rle">rle</a></span>(y)<span class="op">$</span>lengths</a>
<a class="sourceLine" id="cb20-6" title="6">  y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cumsum">cumsum</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rle">rle</a></span>(y)<span class="op">$</span>lengths)</a>
<a class="sourceLine" id="cb20-7" title="7">  y &lt;-<span class="st"> </span>y[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq.int</a></span>(1L, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(y), 2L)]</a>
<a class="sourceLine" id="cb20-8" title="8">  <span class="cf">if</span> (x[[<span class="dv">1</span>]] <span class="op">==</span><span class="st"> </span>x[[<span class="dv">2</span>]]) {</a>
<a class="sourceLine" id="cb20-9" title="9">    y &lt;-<span class="st"> </span>y[<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb20-10" title="10">  }</a>
<a class="sourceLine" id="cb20-11" title="11">  y</a>
<a class="sourceLine" id="cb20-12" title="12">}</a>
<a class="sourceLine" id="cb20-13" title="13"></a>
<a class="sourceLine" id="cb20-14" title="14"><span class="co">## Function which cut x vector at indices given by x.cut.idx,</span></a>
<a class="sourceLine" id="cb20-15" title="15"><span class="co">## approximate cut parts into common length and average </span></a>
<a class="sourceLine" id="cb20-16" title="16"><span class="co">## parts point-wise into one vector</span></a>
<a class="sourceLine" id="cb20-17" title="17">cut.and.avg &lt;-<span class="st"> </span><span class="cf">function</span>(x, x.cut.idx){</a>
<a class="sourceLine" id="cb20-18" title="18">  x.cut.idx.l &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x.cut.idx)</a>
<a class="sourceLine" id="cb20-19" title="19">  mat.out &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="ot">NA</span>, <span class="dt">nrow =</span> x.cut.idx.l<span class="dv">-1</span>, <span class="dt">ncol =</span> <span class="dv">200</span>)</a>
<a class="sourceLine" id="cb20-20" title="20">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x.cut.idx)<span class="op">-</span><span class="dv">1</span>)){</a>
<a class="sourceLine" id="cb20-21" title="21">    xp &lt;-<span class="st"> </span>x[x.cut.idx[i]<span class="op">:</span>x.cut.idx[i<span class="op">+</span><span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb20-22" title="22">    mat.out[i, ] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/approxfun">approx</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(xp)), xp, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">200</span>))<span class="op">$</span>y</a>
<a class="sourceLine" id="cb20-23" title="23">  }</a>
<a class="sourceLine" id="cb20-24" title="24">  out &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(mat.out, <span class="dv">2</span>, mean)</a>
<a class="sourceLine" id="cb20-25" title="25">}</a>
<a class="sourceLine" id="cb20-26" title="26"></a>
<a class="sourceLine" id="cb20-27" title="27"><span class="co">## Make subset of data which has data parts of different speed of running</span></a>
<a class="sourceLine" id="cb20-28" title="28">acc_running_sub2 &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb20-29" title="29"><span class="st">  </span>acc_running <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-30" title="30"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>((date_time <span class="op">&gt;=</span><span class="st"> </span>t2 <span class="op">&amp;</span><span class="st"> </span>date_time <span class="op">&lt;</span><span class="st"> </span>t2 <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/as.period.html">as.period</a></span>(<span class="dv">6</span>, <span class="st">"seconds"</span>)) <span class="op">|</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-31" title="31"><span class="st">           </span>(date_time <span class="op">&gt;=</span><span class="st"> </span>t3 <span class="op">&amp;</span><span class="st"> </span>date_time <span class="op">&lt;</span><span class="st"> </span>t3 <span class="op">+</span><span class="st"> </span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/as.period.html">as.period</a></span>(<span class="dv">6</span>, <span class="st">"seconds"</span>)))  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-32" title="32"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">dt_floor =</span> <span class="kw"><a href="http://lubridate.tidyverse.org/reference/round_date.html">floor_date</a></span>(date_time, <span class="dt">unit =</span> <span class="st">"minutes"</span>))</a>
<a class="sourceLine" id="cb20-33" title="33"><span class="co">## Vector of signatures for data parts of different speed of running</span></a>
<a class="sourceLine" id="cb20-34" title="34">dt_floor.unique &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(acc_running_sub2<span class="op">$</span>dt_floor)</a></code></pre></div>
<div id="deriving-stride-patterns-in-a-semi-manual-way-left-ankle" class="section level5">
<h5 class="hasAnchor">
<a href="#deriving-stride-patterns-in-a-semi-manual-way-left-ankle" class="anchor"></a>Deriving stride patterns in a semi-manual way: left ankle</h5>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co">## Left ankle-specific subset of data  </span></a>
<a class="sourceLine" id="cb21-2" title="2">sub.la &lt;-<span class="st"> </span>acc_running_sub2[acc_running_sub2<span class="op">$</span>sensor_location <span class="op">==</span><span class="st"> "left_ankle"</span>, ]</a>
<a class="sourceLine" id="cb21-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">cex =</span> <span class="fl">0.6</span>)</a>
<a class="sourceLine" id="cb21-4" title="4"></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="co">## Left ankle: template 1</span></a>
<a class="sourceLine" id="cb21-6" title="6">x1 &lt;-<span class="st"> </span>sub.la[sub.la<span class="op">$</span>dt_floor <span class="op">==</span><span class="st"> </span>dt_floor.unique[<span class="dv">1</span>], <span class="st">"vm_smoothed1"</span>]</a>
<a class="sourceLine" id="cb21-7" title="7">x1.locMax &lt;-<span class="st"> </span><span class="kw">localMaxima</span>(x1)</a>
<a class="sourceLine" id="cb21-8" title="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x1), x1, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">main =</span> <span class="st">"(vm) local maxima"</span>, <span class="dt">xlab =</span> <span class="st">"Index"</span>, <span class="dt">ylab =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb21-9" title="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">v =</span> x1.locMax, <span class="dt">col =</span> <span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb21-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x1), x1, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">main =</span> <span class="st">"(vm) local maxima subset"</span>, <span class="dt">xlab =</span> <span class="st">"Index"</span>, <span class="dt">ylab =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb21-11" title="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">v =</span> x1.locMax[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">19</span>, <span class="dv">23</span>, <span class="dv">26</span>, <span class="dv">29</span>)], <span class="dt">col =</span> <span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb21-12" title="12">template.la.x1 &lt;-<span class="st"> </span><span class="kw">cut.and.avg</span>(x1, x1.locMax[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">19</span>, <span class="dv">23</span>, <span class="dv">26</span>, <span class="dv">29</span>)])</a>
<a class="sourceLine" id="cb21-13" title="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(template.la.x1), template.la.x1, <span class="dt">type =</span> <span class="st">"l"</span>, </a>
<a class="sourceLine" id="cb21-14" title="14">     <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">main =</span> <span class="st">"left ankle: template 1"</span>, <span class="dt">xlab =</span> <span class="st">"Index"</span>, <span class="dt">ylab =</span> <span class="st">""</span>)</a></code></pre></div>
<p><img src="adept-strides-segmentation_files/figure-html/semi_manual_la-1.png" width="672"></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="co">## Left ankle: template 2</span></a>
<a class="sourceLine" id="cb22-3" title="3">x2 &lt;-<span class="st"> </span>sub.la[sub.la<span class="op">$</span>dt_floor <span class="op">==</span><span class="st"> </span>dt_floor.unique[<span class="dv">2</span>], <span class="st">"vm_smoothed1"</span>]</a>
<a class="sourceLine" id="cb22-4" title="4">x2.locMax &lt;-<span class="st"> </span><span class="kw">localMaxima</span>(x2)</a>
<a class="sourceLine" id="cb22-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x2), x2, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">main =</span> <span class="st">"(vm) local maxima"</span>, <span class="dt">xlab =</span> <span class="st">"Index"</span>, <span class="dt">ylab =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb22-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">v =</span> x2.locMax, <span class="dt">col =</span> <span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb22-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x2), x2, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">main =</span> <span class="st">"(vm) local maxima subset"</span>, <span class="dt">xlab =</span> <span class="st">"Index"</span>, <span class="dt">ylab =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb22-8" title="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">v =</span> x2.locMax[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">8</span>, <span class="dv">18</span>, <span class="dv">26</span>, <span class="dv">37</span>, <span class="dv">44</span>)], <span class="dt">col =</span> <span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb22-9" title="9">template.la.x2 &lt;-<span class="st"> </span><span class="kw">cut.and.avg</span>(x2, x2.locMax[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">8</span>, <span class="dv">18</span>, <span class="dv">26</span>, <span class="dv">37</span>, <span class="dv">44</span>)])</a>
<a class="sourceLine" id="cb22-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(template.la.x2), template.la.x2, <span class="dt">type =</span> <span class="st">"l"</span>, </a>
<a class="sourceLine" id="cb22-11" title="11">     <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">main =</span> <span class="st">"left ankle: template 2"</span>, <span class="dt">xlab =</span> <span class="st">"Index"</span>, <span class="dt">ylab =</span> <span class="st">""</span>)</a></code></pre></div>
<p><img src="adept-strides-segmentation_files/figure-html/semi_manual_la-2.png" width="672"></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co">## Template object</span></a>
<a class="sourceLine" id="cb23-2" title="2">template.la &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(template.la.x1, template.la.x2)</a></code></pre></div>
</div>
<div id="deriving-stride-patterns-in-a-semi-manual-way-left-hip" class="section level5">
<h5 class="hasAnchor">
<a href="#deriving-stride-patterns-in-a-semi-manual-way-left-hip" class="anchor"></a>Deriving stride patterns in a semi-manual way: left hip</h5>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co">## Left hip-specific subset of data  </span></a>
<a class="sourceLine" id="cb24-2" title="2">sub.lh &lt;-<span class="st"> </span>acc_running_sub2[acc_running_sub2<span class="op">$</span>sensor_location <span class="op">==</span><span class="st"> "left_hip"</span>, ]</a>
<a class="sourceLine" id="cb24-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">cex =</span> <span class="fl">0.6</span>)</a>
<a class="sourceLine" id="cb24-4" title="4"></a>
<a class="sourceLine" id="cb24-5" title="5"><span class="co">## Left hip: template 1 </span></a>
<a class="sourceLine" id="cb24-6" title="6">x1 &lt;-<span class="st"> </span>sub.lh[sub.lh<span class="op">$</span>dt_floor <span class="op">==</span><span class="st"> </span>dt_floor.unique[<span class="dv">1</span>], <span class="st">"vm_smoothed1"</span>]</a>
<a class="sourceLine" id="cb24-7" title="7">x1.locMax &lt;-<span class="st"> </span><span class="kw">localMaxima</span>(x1)</a>
<a class="sourceLine" id="cb24-8" title="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x1), x1, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">main =</span> <span class="st">"(vm) local maxima"</span>, <span class="dt">xlab =</span> <span class="st">"Index"</span>, <span class="dt">ylab =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb24-9" title="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">v =</span> x1.locMax, <span class="dt">col =</span> <span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb24-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x1), x1, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">main =</span> <span class="st">"(vm) local maxima subset"</span>, <span class="dt">xlab =</span> <span class="st">"Index"</span>, <span class="dt">ylab =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb24-11" title="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">v =</span> x1.locMax[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">17</span>, <span class="dv">24</span>, <span class="dv">30</span>, <span class="dv">37</span>, <span class="dv">43</span>, <span class="dv">49</span>, <span class="dv">56</span>)], <span class="dt">col =</span> <span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb24-12" title="12">template.lh.x1 &lt;-<span class="st"> </span><span class="kw">cut.and.avg</span>(x1, x1.locMax[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">17</span>, <span class="dv">24</span>, <span class="dv">30</span>, <span class="dv">37</span>, <span class="dv">43</span>, <span class="dv">49</span>, <span class="dv">56</span>)])</a>
<a class="sourceLine" id="cb24-13" title="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(template.lh.x1), template.lh.x1, <span class="dt">type =</span> <span class="st">"l"</span>, </a>
<a class="sourceLine" id="cb24-14" title="14">     <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">main =</span> <span class="st">"left ankle: template 1"</span>, <span class="dt">xlab =</span> <span class="st">"Index"</span>, <span class="dt">ylab =</span> <span class="st">""</span>)</a></code></pre></div>
<p><img src="adept-strides-segmentation_files/figure-html/semi_manual_lh-1.png" width="672"></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="co">## Left hip: template 2</span></a>
<a class="sourceLine" id="cb25-3" title="3">x2 &lt;-<span class="st"> </span>sub.lh[sub.lh<span class="op">$</span>dt_floor <span class="op">==</span><span class="st"> </span>dt_floor.unique[<span class="dv">2</span>], <span class="st">"vm_smoothed1"</span>]</a>
<a class="sourceLine" id="cb25-4" title="4">x2.locMax &lt;-<span class="st"> </span><span class="kw">localMaxima</span>(x2)</a>
<a class="sourceLine" id="cb25-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x2), x2, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">main =</span> <span class="st">"(vm) local maxima"</span>, <span class="dt">xlab =</span> <span class="st">"Index"</span>, <span class="dt">ylab =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb25-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">v =</span> x2.locMax, <span class="dt">col =</span> <span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb25-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x2), x2, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">main =</span> <span class="st">"(vm) local maxima subset"</span>, <span class="dt">xlab =</span> <span class="st">"Index"</span>, <span class="dt">ylab =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb25-8" title="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">v =</span> x2.locMax[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">5</span>, <span class="dv">13</span>, <span class="dv">19</span>, <span class="dv">24</span>, <span class="dv">31</span>)], <span class="dt">col =</span> <span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb25-9" title="9">template.lh.x2 &lt;-<span class="st"> </span><span class="kw">cut.and.avg</span>(x2, x2.locMax[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">5</span>, <span class="dv">13</span>, <span class="dv">19</span>, <span class="dv">24</span>, <span class="dv">31</span>)])</a>
<a class="sourceLine" id="cb25-10" title="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(template.lh.x2), template.lh.x2, <span class="dt">type =</span> <span class="st">"l"</span>, </a>
<a class="sourceLine" id="cb25-11" title="11">     <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">main =</span> <span class="st">"left ankle: template 2"</span>, <span class="dt">xlab =</span> <span class="st">"Index"</span>, <span class="dt">ylab =</span> <span class="st">""</span>)</a></code></pre></div>
<p><img src="adept-strides-segmentation_files/figure-html/semi_manual_lh-2.png" width="672"></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co">## Template object</span></a>
<a class="sourceLine" id="cb26-2" title="2">template.lh &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(template.lh.x1, template.lh.x2)</a></code></pre></div>
</div>
<div id="segmentation" class="section level5">
<h5 class="hasAnchor">
<a href="#segmentation" class="anchor"></a>Segmentation</h5>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">out2.la &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x.la,</a>
<a class="sourceLine" id="cb27-2" title="2">                          <span class="dt">x.fs =</span> <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb27-3" title="3">                          <span class="dt">template =</span> template.la,</a>
<a class="sourceLine" id="cb27-4" title="4">                          <span class="dt">pattern.dur.seq =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="fl">0.5</span>, <span class="fl">1.8</span>, <span class="dt">length.out =</span> <span class="dv">50</span>),</a>
<a class="sourceLine" id="cb27-5" title="5">                          <span class="dt">similarity.measure =</span> <span class="st">"cor"</span>,</a>
<a class="sourceLine" id="cb27-6" title="6">                          <span class="dt">x.adept.ma.W =</span> <span class="fl">0.15</span>,</a>
<a class="sourceLine" id="cb27-7" title="7">                          <span class="dt">finetune =</span> <span class="st">"maxima"</span>,</a>
<a class="sourceLine" id="cb27-8" title="8">                          <span class="dt">finetune.maxima.ma.W =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb27-9" title="9">                          <span class="dt">finetune.maxima.nbh.W =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb27-10" title="10">                          <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb27-11" title="11">                          <span class="dt">run.parallel =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb27-12" title="12"></a>
<a class="sourceLine" id="cb27-13" title="13">out2.lh &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x.lh,</a>
<a class="sourceLine" id="cb27-14" title="14">                          <span class="dt">x.fs =</span> <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb27-15" title="15">                          <span class="dt">template =</span> template.lh,</a>
<a class="sourceLine" id="cb27-16" title="16">                          <span class="dt">pattern.dur.seq =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="fl">0.5</span>, <span class="fl">1.8</span>, <span class="dt">length.out =</span> <span class="dv">50</span>),</a>
<a class="sourceLine" id="cb27-17" title="17">                          <span class="dt">similarity.measure =</span> <span class="st">"cor"</span>,</a>
<a class="sourceLine" id="cb27-18" title="18">                          <span class="dt">x.adept.ma.W =</span> <span class="fl">0.05</span>,</a>
<a class="sourceLine" id="cb27-19" title="19">                          <span class="dt">finetune =</span> <span class="st">"maxima"</span>,</a>
<a class="sourceLine" id="cb27-20" title="20">                          <span class="dt">finetune.maxima.ma.W =</span> <span class="fl">0.15</span>,</a>
<a class="sourceLine" id="cb27-21" title="21">                          <span class="dt">finetune.maxima.nbh.W =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb27-22" title="22">                          <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb27-23" title="23">                          <span class="dt">run.parallel =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="results-estimated-stride-duration-time-1" class="section level4">
<h4 class="hasAnchor">
<a href="#results-estimated-stride-duration-time-1" class="anchor"></a>Results: estimated stride duration time</h4>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co">## Merge results from two sensor locations, add resting/non-resting info</span></a>
<a class="sourceLine" id="cb28-2" title="2">plt.df.la<span class="fl">.2</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="st">  </span>out2.la <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/merge">merge</a></span>(vmc.df.rest) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-5" title="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(tau_i <span class="op">&gt;=</span><span class="st"> </span>vmc_tau_i, tau_i <span class="op">&lt;</span><span class="st"> </span>vmc_tau_i <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, resting <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-6" title="6"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">location =</span> <span class="st">"left_ankle"</span>)</a>
<a class="sourceLine" id="cb28-7" title="7">plt.df.lh<span class="fl">.2</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb28-8" title="8"><span class="st">  </span>out2.lh <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-9" title="9"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/merge">merge</a></span>(vmc.df.rest) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-10" title="10"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(tau_i <span class="op">&gt;=</span><span class="st"> </span>vmc_tau_i, tau_i <span class="op">&lt;</span><span class="st"> </span>vmc_tau_i <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, resting <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-11" title="11"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">location =</span> <span class="st">"left_hip"</span>)</a>
<a class="sourceLine" id="cb28-12" title="12">plt.df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(plt.df.la<span class="fl">.2</span>, plt.df.lh<span class="fl">.2</span>)</a>
<a class="sourceLine" id="cb28-13" title="13"></a>
<a class="sourceLine" id="cb28-14" title="14"><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(plt.df,</a>
<a class="sourceLine" id="cb28-15" title="15">    <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> tau_i <span class="op">/</span><span class="st"> </span>(<span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="dv">60</span>) , <span class="dt">y =</span> T_i <span class="op">/</span><span class="st"> </span><span class="dv">100</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-16" title="16"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_tile">geom_tile</a></span>(<span class="dt">data =</span> vmc.df.rest, </a>
<a class="sourceLine" id="cb28-17" title="17">            <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> vmc_tau_i <span class="op">/</span><span class="st"> </span>(<span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="dv">60</span>), <span class="dt">y =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(resting)), </a>
<a class="sourceLine" id="cb28-18" title="18">            <span class="dt">height =</span> <span class="ot">Inf</span>, <span class="dt">alpha =</span> <span class="fl">0.1</span>, <span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-19" title="19"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-20" title="20"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/facet_grid">facet_grid</a></span>(location <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-21" title="21"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-22" title="22"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"Exercise time [min]"</span>, <span class="dt">y =</span> <span class="st">"Estimated stride duration time [s]"</span>,</a>
<a class="sourceLine" id="cb28-23" title="23">       <span class="dt">fill =</span> <span class="st">"Resting: "</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-24" title="24"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"top"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-25" title="25"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/scale_manual">scale_fill_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"white"</span>, <span class="st">"blue"</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-26" title="26"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"top"</span>,</a>
<a class="sourceLine" id="cb28-27" title="27">        <span class="dt">legend.background =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/element">element_rect</a></span>(<span class="dt">fill =</span> <span class="st">"grey90"</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-28" title="28"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/scale_continuous">scale_y_continuous</a></span>(<span class="dt">limits =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.5</span>, <span class="fl">1.8</span>))</a></code></pre></div>
<p><img src="adept-strides-segmentation_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
<div id="observations-4" class="section level5">
<h5 class="hasAnchor">
<a href="#observations-4" class="anchor"></a>Observations</h5>
<ul>
<li>From the plot above we see that the estimated stride duration times are fairly consistent between the two sensor locations, and also consistent with the estimates we obtained based on external, pre-computed stride pattern templates.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>References:</p>
<p>1: Karas, M., Straczkiewicz, M., Fadel, W., Harezlak, J., Crainiceanu, C., Urbanek, J.K. Adaptive empirical pattern transformation (ADEPT) with application to walking stride segmentation, Submitted to Biostatistics, 2018.</p>
<p>2: Karas, M., Bai, J., Straczkiewicz, M., Harezlak, J., Glynn, N W., Harris, T., Zipunnikov, V., Crainiceanu, C., Urbanek, J.K. Accelerometry data in health research: challenges and opportunities. Review and examples, Statistics in Biosciences, 2018. (<a href="https://rdcu.be/bgLtM">link</a>)</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#raw-accelerometry-data-sample">Raw accelerometry data sample</a></li>
      <li><a href="#accelerometry-data-visualization">Accelerometry data visualization</a></li>
      <li><a href="#walking-strides-segmentation">Walking strides segmentation</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Marta Karas, Jacek Urbanek, Ciprian Crainiceanu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
