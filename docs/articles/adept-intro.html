<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to adept package • adept</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to adept package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adept</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/adept-intro.html">Introduction to adept package</a>
    </li>
    <li>
      <a href="../articles/adept-strides-segmentation.html">Walking strides segmentation with `adept`</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/martakarass/adept">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to adept package</h1>
                        <h4 class="author">Marta Karas</h4>
            
            <h4 class="date">2019-03-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/martakarass/adept/blob/master/vignettes/adept-intro.Rmd"><code>vignettes/adept-intro.Rmd</code></a></small>
      <div class="hidden name"><code>adept-intro.Rmd</code></div>

    </div>

    
    
<div id="intro" class="section level1">
<h1 class="hasAnchor">
<a href="#intro" class="anchor"></a>Intro</h1>
<p><code>adept</code> package implements ADaptive Empirical Pattern Transformation (ADEPT) ([1]) <strong>method for pattern segmentation from a time-series <code>x</code></strong>. ADEPT was designed for optimal use in performing fast, accurate walking strides segmentation from high-density data collected from a wearable accelerometer worn during continuous walking activity. <!-- It has been tested ([1]) for data collected with sensors worn at left wrist, left hip and both ankles.  --></p>
<p>This vignette intends to introduce a reader to the ADEPT method and demonstrate the usage of the <code>segmentPattern</code> function which implements ADEPT method. Here, we focus on illustrating <code>segmentPattern</code> functionality via simulated data examples; see the *Walking strides segmentation with <code>adept</code>“* vignette ([2]) for an example of walking stride segmentation from subsecond accelerometry data with <code>adept</code> package.</p>
</div>
<div id="adept-method" class="section level1">
<h1 class="hasAnchor">
<a href="#adept-method" class="anchor"></a>ADEPT method</h1>
<p>ADEPT identifies pattern occurrences from a time-series <code>x</code> via maximizing similarity (correlation, covariance etc.) between time-series <code>x</code> windows and a pattern template(s). It accounts for a possible presence of variation in both (1) pattern occurrence duration time and (2) shape over time:</p>
<ol style="list-style-type: decimal">
<li><p>Consider an example in which a pattern occurrence is changing, possibly multiple times, its duration time within a time-series <code>x</code>. To address such scenario, <strong>ADEPT considers various scales of a pattern template(s)</strong> to allow for obtaining the higher similarity between a time-series <code>x</code> and a template.</p></li>
<li><p>Consider an example in which an event we aim to segment takes more than one distinct pattern shape within time-series <code>x</code>. To address such scenario, <strong>multiple pattern templates are allowed simultaneously</strong> in the ADEPT method.</p></li>
</ol>
<!-- 1. Consider an example in which a pattern occurrence is changing, possibly multiple times, its duration time within time-series `x`. In the context of walking strides segmentation, one may think about an elderly person slowing down pace during a six-minute walk test, or a marathonist adjusting the running pace over the course of a race; moreover, a stride duration time may differ naturally between subjects of a study group from which the data were collected.   --><!--     To address such scenario, **ADEPT considers various scales of a pattern template(s)** to allow for obtaining the higher similarity between time-series `x` and a template. --><!-- 2. Further, consider an example in which there is a change of a pattern shape over time or/and between participants the data were collected from. In the context of walking strides segmentation, one may consider a study group consisting of healthy and limping participants; it would be plausible to expect variations in a walking stride shape between the participants in such a group.  --><!--     To address that a pattern may potentially be changing its shape, **multiple pattern templates are allowed simultaneously** in the ADEPT method.  --><div id="pattern-template" class="section level2">
<h2 class="hasAnchor">
<a href="#pattern-template" class="anchor"></a>Pattern template</h2>
<p>Here, a pattern template is thought of as a numeric vector that represents the pattern of interest. In practice, a pattern template may be derived based on some pre-segmented small part of the data.</p>
<ul>
<li>See [1] where we show a way to derive walking stride templates from subsecond accelerometry data collected from sensors worn at left wrist, left hip and both ankles.</li>
<li>See [2] for an example of employing walking stride templates derived in [1] to segment pattern from a separate, publicly available subsecond-level accelerometry data.</li>
</ul>
<p>In this vignette, for the purpose of the presentation, a pattern template(s) will be a simulated data vector(s).</p>
</div>
</div>
<div id="install-and-load-adept-package" class="section level1">
<h1 class="hasAnchor">
<a href="#install-and-load-adept-package" class="anchor"></a>Install and load <code>adept</code> package</h1>
<p>If not installed yet, install <code>adept</code> package from GitHub (<code>devtools</code> package needs to be installed to do it).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages("devtools")       ## for installing packages from GitHub repository</span>
devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"martakarass/adept"</span>)</code></pre></div>
<p>Load <code>adept</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(adept)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(magrittr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</code></pre></div>
</div>
<div id="pattern-segmentation-with-adept-package" class="section level1">
<h1 class="hasAnchor">
<a href="#pattern-segmentation-with-adept-package" class="anchor"></a>Pattern segmentation with <code>adept</code> package</h1>
<p>The examples below are organized into suites.</p>
<ul>
<li>Suites are characterized by some specific data generation setting, for example: <em>Examples 1: signals simulated with no noise, same-length pattern</em>.</li>
<li>Examples are intended to illustrate <code>segmentPattern</code> functionality, including effect of the function’s parameter usage, for example: <em>Example 1(b): simple segmentation, modify <code>pattern.dur.seq</code> argument</em>.</li>
</ul>
<div id="examples-1-signals-simulated-with-no-noise-same-length-of-all-pattern-occurrences" class="section level2">
<h2 class="hasAnchor">
<a href="#examples-1-signals-simulated-with-no-noise-same-length-of-all-pattern-occurrences" class="anchor"></a>Examples 1: signals simulated with no noise, same length of all pattern occurrences</h2>
<div id="simulate-data" class="section level3">
<h3 class="hasAnchor">
<a href="#simulate-data" class="anchor"></a>Simulate data</h3>
<p>Simulate data:</p>
<ul>
<li>no noise in a simulated time-series <code>x</code>,</li>
<li>all simulated pattern occurrences of the same length (vector length: <code>101</code>).</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Generate signal and pattern template
x0 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">cos</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span><span class="dv">10</span>, <span class="dt">length.out =</span> <span class="dv">1001</span>))
x  &lt;-<span class="st"> </span>x0
template &lt;-<span class="st"> </span>x0[<span class="dv">1</span><span class="op">:</span><span class="dv">101</span>]

## Plot time-series `x`
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x), <span class="dt">y =</span> x) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"Time [s]"</span>, <span class="dt">y =</span> <span class="st">"Value"</span>, <span class="dt">title =</span> <span class="st">"Time-series x"</span>)</code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>Plot pattern template. We shall use <code>template</code> object in the segmentation algorithm.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">101</span>), <span class="dt">y =</span> template) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y), <span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"Template phase"</span>, <span class="dt">y =</span> <span class="st">"Value"</span>, <span class="dt">title =</span> <span class="st">"Pattern template"</span>)</code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-4-1.png" width="240"></p>
</div>
<div id="example-1a-run-simple-segmentation" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1a-run-simple-segmentation" class="anchor"></a>Example 1(a): run simple segmentation</h3>
<p>Use <code>segmentPattern</code> function to identify pattern occurrences within a time-series <code>x</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pattern.dur.seq &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">90</span>, <span class="dv">100</span>, <span class="dv">110</span>)
out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x,
                      <span class="dt">x.fs =</span> <span class="dv">1</span>,
                      <span class="dt">template =</span> template,
                      <span class="dt">pattern.dur.seq =</span> pattern.dur.seq,
                      <span class="dt">similarity.measure =</span> <span class="st">"cor"</span>,
                      <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>)
out
<span class="co">#&gt;    tau_i T_i     sim_i template_i</span>
<span class="co">#&gt; 1      1 100 0.9994793          1</span>
<span class="co">#&gt; 2    101 100 0.9994793          1</span>
<span class="co">#&gt; 3    201 100 0.9994793          1</span>
<span class="co">#&gt; 4    302 100 0.9994793          1</span>
<span class="co">#&gt; 5    401 100 0.9994793          1</span>
<span class="co">#&gt; 6    501 100 0.9994793          1</span>
<span class="co">#&gt; 7    601 100 0.9994793          1</span>
<span class="co">#&gt; 8    701 100 0.9994793          1</span>
<span class="co">#&gt; 9    801 100 0.9994793          1</span>
<span class="co">#&gt; 10   901 100 0.9994793          1</span></code></pre></div>
<div id="segmentation-output-explained" class="section level4">
<h4 class="hasAnchor">
<a href="#segmentation-output-explained" class="anchor"></a>Segmentation output explained</h4>
<p>Each row of the output data frame (here: <code>out</code> object above) summarizes information about one identified pattern occurrence:</p>
<ul>
<li>
<code>tau_i</code> - pattern occurrence start, expressed as an index of a time-series <code>x</code>,</li>
<li>
<code>T_i</code> - pattern occurrence duration, expressed in a time-series <code>x</code> vector length,</li>
<li>
<code>sim_i</code> - value of similarity statistic (here: correlation) between a pattern template and corresponding window of a time-series <code>x</code> (see Details in <code>segmentPattern</code> documentation),</li>
<li>
<code>template_i</code> - index of a pattern template corresponding to an identified pattern occurrence, or <code>NA</code> if <code>compute.template.idx = FALSE</code> is used (see Details in <code>segmentPattern</code> documentation); here: we provided only one distinct pattern template, hence all <code>template_i</code>’s are equal 1.</li>
</ul>
</div>
</div>
<div id="example-1b-use-pattern-dur-seq-argument-to-modify-a-grid-of-pattern-duration" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1b-use-pattern-dur-seq-argument-to-modify-a-grid-of-pattern-duration" class="anchor"></a>Example 1(b): use <code>pattern.dur.seq</code> argument to modify a grid of pattern duration</h3>
<p>Similarly, we aim to 3identify pattern occurrences within a time-series <code>x</code>, but this time we include the true pattern duration time <code>101</code> in a grid of considered pattern durations (<code>pattern.dur.seq</code>).</p>
<p>We shall see that <code>sim_i</code> - a value of similarity statistic (here: correlation) - is now equal to <code>1</code> for each identified pattern occurrence. In other words, a perfect match between a time-series <code>x</code> and a template was obtained. It is possible because:</p>
<ul>
<li>the simulated time-series <code>x</code> has no noise,</li>
<li>we used a true (gold-standard) pattern template (<code>template</code>),</li>
<li>we used true pattern duration time <code>101</code> in a grid of considered pattern durations (<code>pattern.dur.seq</code>).</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pattern.dur.seq &lt;-<span class="st"> </span><span class="dv">90</span><span class="op">:</span><span class="dv">110</span>  ## assume dense pattern duration grid ranging 90-110 seconds
out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x,
                      <span class="dt">x.fs =</span> <span class="dv">1</span>,  ## assume data frequency 1 observation per second
                      <span class="dt">template =</span> template,
                      <span class="dt">pattern.dur.seq =</span> pattern.dur.seq,
                      <span class="dt">similarity.measure =</span> <span class="st">"cor"</span>,
                      <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>)
out
<span class="co">#&gt;    tau_i T_i sim_i template_i</span>
<span class="co">#&gt; 1      1 101     1          1</span>
<span class="co">#&gt; 2    101 101     1          1</span>
<span class="co">#&gt; 3    201 101     1          1</span>
<span class="co">#&gt; 4    301 101     1          1</span>
<span class="co">#&gt; 5    401 101     1          1</span>
<span class="co">#&gt; 6    501 101     1          1</span>
<span class="co">#&gt; 7    601 101     1          1</span>
<span class="co">#&gt; 8    701 101     1          1</span>
<span class="co">#&gt; 9    801 101     1          1</span>
<span class="co">#&gt; 10   901 101     1          1</span></code></pre></div>
</div>
<div id="example-1c-use-x-fs-argument-to-modify-assumed-frequency-at-which-a-time-series-x-is-collected" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1c-use-x-fs-argument-to-modify-assumed-frequency-at-which-a-time-series-x-is-collected" class="anchor"></a>Example 1(c): use <code>x.fs</code> argument to modify assumed frequency at which a time-series <code>x</code> is collected</h3>
<p>The below example demonstrates usage of <code>x.fs</code> parameter. We shall see that if we:</p>
<ul>
<li>modify <code>x.fs</code> - assumed frequency at which a time-series <code>x</code> is collected, expressed in a number of observations per second,</li>
<li>adjust accordingly <code>pattern.dur.seq</code> - assumed grid of pattern duration times used in segmentation, expressed in seconds,</li>
</ul>
<p>then the segmentation results stay the same as in <em>Example 1(b)</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pattern.dur.seq &lt;-<span class="st"> </span><span class="dv">90</span><span class="op">:</span><span class="dv">110</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.01</span>   ## assume pattern duration grid ranging 0.9-1.1 seconds
out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x,
                      <span class="dt">x.fs =</span> <span class="dv">100</span>,   ## assume data frequency 100 observations per second
                      <span class="dt">template =</span> template,
                      <span class="dt">pattern.dur.seq =</span> pattern.dur.seq,
                      <span class="dt">similarity.measure =</span> <span class="st">"cor"</span>,
                      <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>)
out
<span class="co">#&gt;    tau_i T_i sim_i template_i</span>
<span class="co">#&gt; 1      1 101     1          1</span>
<span class="co">#&gt; 2    101 101     1          1</span>
<span class="co">#&gt; 3    201 101     1          1</span>
<span class="co">#&gt; 4    301 101     1          1</span>
<span class="co">#&gt; 5    401 101     1          1</span>
<span class="co">#&gt; 6    501 101     1          1</span>
<span class="co">#&gt; 7    601 101     1          1</span>
<span class="co">#&gt; 8    701 101     1          1</span>
<span class="co">#&gt; 9    801 101     1          1</span>
<span class="co">#&gt; 10   901 101     1          1</span></code></pre></div>
</div>
</div>
<div id="examples-2-signals-simulated-with-no-noise-length-of-pattern-occurrences-varies" class="section level2">
<h2 class="hasAnchor">
<a href="#examples-2-signals-simulated-with-no-noise-length-of-pattern-occurrences-varies" class="anchor"></a>Examples 2: signals simulated with no noise, length of pattern occurrences varies</h2>
<div id="simulate-data-1" class="section level3">
<h3 class="hasAnchor">
<a href="#simulate-data-1" class="anchor"></a>Simulate data</h3>
<p>Simulate data:</p>
<ul>
<li>no noise in a simulated time-series <code>x</code>,</li>
<li>length of simulated pattern occurrences varies (their vector length ranges between <code>60</code> and <code>120</code>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Generate signal and pattern template
## Grid of true pattern occurrence durations
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">1</span>)
s.grid &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">60</span><span class="op">:</span><span class="dv">120</span>, <span class="dt">size =</span> <span class="dv">10</span>)
## True pattern assumed in data generation process
true.pattern &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">cos</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi, <span class="dt">length.out =</span> <span class="dv">200</span>))

## Generate a time-series x that consists of "glued" pattern occurrences 
## of different length 
x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">numeric</a></span>()
<span class="cf">for</span> (s.tmp <span class="cf">in</span> s.grid){
  true.pattern.s &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/approxfun">approx</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">200</span>), 
                            true.pattern, 
                            <span class="dt">xout =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> s.tmp))<span class="op">$</span>y
  <span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>){
    x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(x, true.pattern.s[<span class="op">-</span><span class="dv">1</span>])
  } <span class="cf">else</span> {
    x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(x, true.pattern.s)
  }
}

## Define template 
template &lt;-<span class="st"> </span>true.pattern

## Plot time-series `x`
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x), <span class="dt">y =</span> x) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"Time [s]"</span>, <span class="dt">y =</span> <span class="st">"Value"</span>, <span class="dt">title =</span> <span class="st">"Time-series x"</span>)</code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>Plot pattern template (it is the same as in <em>Examples 1</em>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(template)), <span class="dt">y =</span> template) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y), <span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"Template phase"</span>, <span class="dt">y =</span> <span class="st">"Value"</span>, <span class="dt">title =</span> <span class="st">"Pattern template"</span>)</code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-9-1.png" width="240"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Function to plot segmentation results in a fancy way with ggplot2
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)
out.plot1 &lt;-<span class="st"> </span><span class="cf">function</span>(val, out){

  yrange &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(val))
  y.h &lt;-<span class="st"> </span><span class="dv">0</span>
  plt &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>()
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(out)){
    tau1_i &lt;-<span class="st"> </span>out[i, <span class="st">"tau_i"</span>]
    tau2_i &lt;-<span class="st"> </span>tau1_i <span class="op">+</span><span class="st"> </span>out[i, <span class="st">"T_i"</span>] <span class="op">-</span><span class="st"> </span><span class="dv">1</span>
    plt &lt;-<span class="st"> </span>
<span class="st">      </span>plt <span class="op">+</span><span class="st"> </span>
<span class="st">      </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="dt">xintercept =</span> tau1_i, <span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">      </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="dt">xintercept =</span> tau2_i, <span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">      </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span>(
        <span class="st">"rect"</span>,
        <span class="dt">fill =</span> <span class="st">"pink"</span>, 
        <span class="dt">alpha =</span> <span class="fl">0.3</span>,
        <span class="dt">xmin =</span> tau1_i, 
        <span class="dt">xmax =</span> tau2_i, 
        <span class="dt">ymin =</span> yrange[<span class="dv">1</span>],
        <span class="dt">ymax =</span> yrange[<span class="dv">2</span>]
    )
  }
  plt &lt;-<span class="st"> </span>
<span class="st">    </span>plt <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(val), <span class="dt">y =</span> val), 
              <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y), 
              <span class="dt">color =</span> <span class="st">"black"</span>, 
              <span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"Time [s]"</span>, <span class="dt">y =</span> <span class="st">"Black line: x"</span>,
         <span class="dt">title =</span> <span class="st">"Black line: signal x</span><span class="ch">\n</span><span class="st">Red vertical lines: start and end points of identified pattern occurrence</span><span class="ch">\n</span><span class="st">Red shaded area: area corresponding to identified pattern occurrence"</span>)
  <span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(plt)
}</code></pre></div>
</div>
<div id="example-2a-run-simple-segmentation" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2a-run-simple-segmentation" class="anchor"></a>Example 2(a): run simple segmentation</h3>
<p>By using a dense grid of duration of pattern occurrences (<code>pattern.dur.seq</code>), we shall obtain a perfect match between time-series <code>x</code> and a template rescaled to various scale parameters. Hence, in the segmentation results plot below, one can see that the start and end points of an individual identified pattern occurrence, marked with red vertical lines, do overlap.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pattern.dur.seq &lt;-<span class="st"> </span><span class="dv">60</span><span class="op">:</span><span class="dv">120</span>
out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x,
                      <span class="dt">x.fs =</span> <span class="dv">1</span>,
                      <span class="dt">template =</span> template,
                      <span class="dt">pattern.dur.seq =</span> pattern.dur.seq,
                      <span class="dt">similarity.measure =</span> <span class="st">"cor"</span>,
                      <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>)
out
<span class="co">#&gt;    tau_i T_i sim_i template_i</span>
<span class="co">#&gt; 1      1  76     1          1</span>
<span class="co">#&gt; 2     76  82     1          1</span>
<span class="co">#&gt; 3    157  93     1          1</span>
<span class="co">#&gt; 4    249 112     1          1</span>
<span class="co">#&gt; 5    360  71     1          1</span>
<span class="co">#&gt; 6    430 110     1          1</span>
<span class="co">#&gt; 7    539 111     1          1</span>
<span class="co">#&gt; 8    649  95     1          1</span>
<span class="co">#&gt; 9    743 118     1          1</span>
<span class="co">#&gt; 10   860  63     1          1</span>

## Plot segmetation results
<span class="kw">out.plot1</span>(x, out)</code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
</div>
<div id="example-2b-run-simple-segmentation-with-less-dense-grid-of-assumed-duration-of-pattern-occurrences" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2b-run-simple-segmentation-with-less-dense-grid-of-assumed-duration-of-pattern-occurrences" class="anchor"></a>Example 2(b): run simple segmentation with less dense grid of assumed duration of pattern occurrences</h3>
<p>In this example we employ a less dense grid of assumed duration of pattern occurrences (<code>pattern.dur.seq</code>). As a result, we no longer see a perfect match between a time-series <code>x</code> and a template; we shall see that <code>sim_i</code> values are not all equal to <code>1</code> and we do see a lack of overlap between the start and end points of an individual identified pattern occurrence, as marked with red vertical lines.</p>
<ul>
<li>The reason to consider a less dense <code>pattern.dur.seq</code> grid of assumed duration of pattern occurrence in segmentation is a shorter computational time.</li>
<li>We will see later that when <em>peak detection tuning procedure</em> is employed, having a “maximally dense” grid is not necessarily needed.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pattern.dur.seq &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">60</span>, <span class="dv">90</span>, <span class="dv">120</span>)
out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x,
                      <span class="dt">x.fs =</span> <span class="dv">1</span>,
                      <span class="dt">template =</span> template,
                      <span class="dt">pattern.dur.seq =</span> pattern.dur.seq,
                      <span class="dt">similarity.measure =</span> <span class="st">"cor"</span>,
                      <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>)
out
<span class="co">#&gt;    tau_i T_i     sim_i template_i</span>
<span class="co">#&gt; 1      9  60 0.9913537          1</span>
<span class="co">#&gt; 2     87  60 0.9875419          1</span>
<span class="co">#&gt; 3    159  90 0.9991040          1</span>
<span class="co">#&gt; 4    260  90 0.9925351          1</span>
<span class="co">#&gt; 5    366  60 0.9933033          1</span>
<span class="co">#&gt; 6    425 120 0.9967502          1</span>
<span class="co">#&gt; 7    549  90 0.9923207          1</span>
<span class="co">#&gt; 8    651  90 0.9986598          1</span>
<span class="co">#&gt; 9    742 120 0.9999117          1</span>
<span class="co">#&gt; 10   861  60 0.9979972          1</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">out.plot1</span>(x, out)</code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
<div id="example-2c-use-similarity-measure-argument-to-use-covariance-as-similarity-statistic" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2c-use-similarity-measure-argument-to-use-covariance-as-similarity-statistic" class="anchor"></a>Example 2(c): use <code>similarity.measure</code> argument to use covariance as similarity statistic</h3>
<p>Similar as above, but here we use covariance as a similarity measure statistic. We shall observe that <code>sim_i</code> values in the result data frame change and the segmentation results change slightly (explanation: a change of similarity statistic values may affect ADEPT iterative maximization procedure results).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pattern.dur.seq &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">60</span>, <span class="dv">90</span>, <span class="dv">120</span>)
out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x,
                      <span class="dt">x.fs =</span> <span class="dv">1</span>,
                      <span class="dt">template =</span> template,
                      <span class="dt">pattern.dur.seq =</span> pattern.dur.seq,
                      <span class="dt">similarity.measure =</span> <span class="st">"cov"</span>,  ## use covariance as a similarity measure statistic
                      <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>)
out
<span class="co">#&gt;    tau_i T_i     sim_i template_i</span>
<span class="co">#&gt; 1      9  60 0.5918631          1</span>
<span class="co">#&gt; 2     72  90 0.7339804          1</span>
<span class="co">#&gt; 3    174  60 0.4559175          1</span>
<span class="co">#&gt; 4    245 120 0.7289255          1</span>
<span class="co">#&gt; 5    366  60 0.6348018          1</span>
<span class="co">#&gt; 6    440  90 0.6108531          1</span>
<span class="co">#&gt; 7    534 120 0.7306629          1</span>
<span class="co">#&gt; 8    653  90 0.6897910          1</span>
<span class="co">#&gt; 9    742 120 0.7182487          1</span>
<span class="co">#&gt; 10   861  60 0.6989475          1</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">out.plot1</span>(x, out)</code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
</div>
</div>
<div id="examples-3-signals-simulated-with-no-noise-length-of-pattern-occurrences-and-pattern-shape-vary" class="section level2">
<h2 class="hasAnchor">
<a href="#examples-3-signals-simulated-with-no-noise-length-of-pattern-occurrences-and-pattern-shape-vary" class="anchor"></a>Examples 3: signals simulated with no noise, length of pattern occurrences and pattern shape vary</h2>
<div id="simulate-data-2" class="section level3">
<h3 class="hasAnchor">
<a href="#simulate-data-2" class="anchor"></a>Simulate data</h3>
<p>Simulate data:</p>
<ul>
<li>no noise in simulated time-series <code>x</code>,</li>
<li>length of simulated pattern occurrences varies (vector length ranges between <code>60</code> and <code>120</code>),</li>
<li>two different true pattern shapes within a time-series <code>x</code>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Grid of different true pattern occurrence durations</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">1</span>)
s.grid &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="dv">60</span><span class="op">:</span><span class="dv">120</span>, <span class="dt">size =</span> <span class="dv">5</span>)
true.pattern.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">cos</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi, <span class="dt">length.out =</span> <span class="dv">200</span>))
true.pattern.<span class="dv">2</span> &lt;-<span class="st"> </span>true.pattern.<span class="dv">1</span>
seq.tmp &lt;-<span class="st"> </span><span class="dv">70</span><span class="op">:</span><span class="dv">130</span>
true.pattern.<span class="dv">2</span>[seq.tmp] &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>true.pattern.<span class="dv">2</span>[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(seq.tmp)] <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(true.pattern.<span class="dv">2</span>[seq.tmp])

## Generate signal x that consists of "glued" pattern occurrences of different length
x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">numeric</a></span>()
<span class="cf">for</span> (ss <span class="cf">in</span> s.grid){
  ## Add a part from from true.pattern.1
  true.pattern.<span class="fl">1.</span>s &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/approxfun">approx</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">200</span>), 
                             true.pattern.<span class="dv">1</span>, 
                             <span class="dt">xout =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> ss))<span class="op">$</span>y
  <span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>){
    x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(x, true.pattern.<span class="fl">1.</span>s[<span class="op">-</span><span class="dv">1</span>])
  } <span class="cf">else</span> {
    x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(x, true.pattern.<span class="fl">1.</span>s)
  }
  ## Add a part from from true.pattern.2
  true.pattern.<span class="fl">2.</span>s &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/approxfun">approx</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">200</span>), 
                             true.pattern.<span class="dv">2</span>, 
                             <span class="dt">xout =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> ss))<span class="op">$</span>y
  x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(x, true.pattern.<span class="fl">2.</span>s[<span class="op">-</span><span class="dv">1</span>])
}

## Plot time-series `x`
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x), <span class="dt">y =</span> x) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"Time [s]"</span>, <span class="dt">y =</span> <span class="st">"Value"</span>, <span class="dt">title =</span> <span class="st">"Time-series x"</span>)</code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
<p>Plot two vectors that were used in the data generation process as the true patterns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plt1 &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(true.pattern.<span class="dv">1</span>)), <span class="dt">y =</span> true.pattern.<span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y), <span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"Template phase"</span>, <span class="dt">y =</span> <span class="st">"Value"</span>, <span class="dt">title =</span> <span class="st">"Pattern template 1"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="dt">limits =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))
plt2 &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(true.pattern.<span class="dv">2</span>)), <span class="dt">y =</span> true.pattern.<span class="dv">2</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y), <span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"Template phase"</span>, <span class="dt">y =</span> <span class="st">"Value"</span>, <span class="dt">title =</span> <span class="st">"Pattern template 2"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="dt">limits =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))
plt1;plt2</code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-17-1.png" width="240"><img src="adept-intro_files/figure-html/unnamed-chunk-17-2.png" width="240"></p>
</div>
<div id="example-3a-run-simple-segmentation" class="section level3">
<h3 class="hasAnchor">
<a href="#example-3a-run-simple-segmentation" class="anchor"></a>Example 3(a): run simple segmentation</h3>
<p>We use a dense grid of duration of pattern occurrences (<code>pattern.dur.seq</code>). We firstly use a template consisting of only one “true” pattern. We shall see that:</p>
<ul>
<li>first and every other subsequent pattern occurrence identified has corresponding correlation <code>sim_i</code> equal to <code>1</code>; these pattern occurrences were generated with the use of a pattern template <code>true.pattern.1</code> we supplied to the segmentation algorithm,<br>
</li>
<li>second and every other subsequent pattern occurrence identified has corresponding correlation <code>sim_i</code> smaller than <code>1</code>; these pattern occurrences were generated with the use of a pattern template <code>true.pattern.2</code> we did not supply to the segmentation algorithm.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pattern.dur.seq &lt;-<span class="st"> </span><span class="dv">60</span><span class="op">:</span><span class="dv">120</span>
template &lt;-<span class="st"> </span>true.pattern.<span class="dv">1</span>
  
out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x,
                      <span class="dt">x.fs =</span> <span class="dv">1</span>,
                      <span class="dt">template =</span> template,
                      <span class="dt">pattern.dur.seq =</span> pattern.dur.seq,
                      <span class="dt">similarity.measure =</span> <span class="st">"cor"</span>,
                      <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>)
out
<span class="co">#&gt;    tau_i T_i     sim_i template_i</span>
<span class="co">#&gt; 1      1  76 1.0000000          1</span>
<span class="co">#&gt; 2     76  76 0.9288369          1</span>
<span class="co">#&gt; 3    151  82 1.0000000          1</span>
<span class="co">#&gt; 4    232  82 0.9288407          1</span>
<span class="co">#&gt; 5    313  93 1.0000000          1</span>
<span class="co">#&gt; 6    405  93 0.9286870          1</span>
<span class="co">#&gt; 7    497 112 1.0000000          1</span>
<span class="co">#&gt; 8    608 112 0.9285767          1</span>
<span class="co">#&gt; 9    719  71 1.0000000          1</span>
<span class="co">#&gt; 10   789  71 0.9292973          1</span>

## Plot segmetation results
<span class="kw">out.plot1</span>(x, out)</code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
</div>
<div id="example-3b-use-similarity-measure-thresh-argument-to-set-a-threshold-of-minimal-similarity-value" class="section level3">
<h3 class="hasAnchor">
<a href="#example-3b-use-similarity-measure-thresh-argument-to-set-a-threshold-of-minimal-similarity-value" class="anchor"></a>Example 3(b): use <code>similarity.measure.thresh</code> argument to set a threshold of minimal similarity value</h3>
<p>Similar as above, but here we additionally use a <code>0.95</code> threshold of minimal similarity value (here: covariance) between a time-series <code>x</code> and pattern template below which the algorithm does not identify a pattern occurrence. Default is <code>0</code>. Consequently we shall see that only the pattern occurrences for which <code>sim_i</code> value is greater than <code>0.95</code> are identified.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pattern.dur.seq &lt;-<span class="st"> </span><span class="dv">60</span><span class="op">:</span><span class="dv">120</span>
template &lt;-<span class="st"> </span>true.pattern.<span class="dv">1</span>
  
out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x,
                      <span class="dt">x.fs =</span> <span class="dv">1</span>,
                      <span class="dt">template =</span> template,
                      <span class="dt">pattern.dur.seq =</span> pattern.dur.seq,
                      <span class="dt">similarity.measure =</span> <span class="st">"cor"</span>,
                      <span class="dt">similarity.measure.thresh =</span> <span class="fl">0.95</span>, 
                      <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>)
out
<span class="co">#&gt;   tau_i T_i sim_i template_i</span>
<span class="co">#&gt; 1     1  76     1          1</span>
<span class="co">#&gt; 2   151  82     1          1</span>
<span class="co">#&gt; 3   313  93     1          1</span>
<span class="co">#&gt; 4   497 112     1          1</span>
<span class="co">#&gt; 5   719  71     1          1</span>

## Plot segmetation results
<span class="kw">out.plot1</span>(x, out)</code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
</div>
<div id="example-3c-use-multiple-distinct-pattern-templates" class="section level3">
<h3 class="hasAnchor">
<a href="#example-3c-use-multiple-distinct-pattern-templates" class="anchor"></a>Example 3(c): use multiple distinct pattern templates</h3>
<p>Similarly as above, but now we use two distinct pattern templates in the <code>template</code> argument. As expected, now we see that every pattern occurrence identified has corresponding correlation <code>sim_i</code> equal to <code>1</code>. It is because these pattern occurrences were generated with the use of either a pattern template <code>true.pattern.1</code> or <code>true.pattern.2</code>, and we supplied <em>both</em> of them to the segmentation algorithm.</p>
<p>The column <code>template_i</code> in a returned data frame shall show numbers <code>1</code> and <code>2</code> interchangeably; the number is an indicator of pattern template that yielded particular identified pattern occurrence (see <code>segmentPattern</code> documentation manual for details).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pattern.dur.seq &lt;-<span class="st"> </span><span class="dv">60</span><span class="op">:</span><span class="dv">120</span>
template &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(true.pattern.<span class="dv">1</span>,
                 true.pattern.<span class="dv">2</span>)
  
out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x,
                      <span class="dt">x.fs =</span> <span class="dv">1</span>,
                      <span class="dt">template =</span> template,
                      <span class="dt">pattern.dur.seq =</span> pattern.dur.seq,
                      <span class="dt">similarity.measure =</span> <span class="st">"cor"</span>,
                      <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>)
out
<span class="co">#&gt;    tau_i T_i sim_i template_i</span>
<span class="co">#&gt; 1      1  76     1          1</span>
<span class="co">#&gt; 2     76  76     1          2</span>
<span class="co">#&gt; 3    151  82     1          1</span>
<span class="co">#&gt; 4    232  82     1          2</span>
<span class="co">#&gt; 5    313  93     1          1</span>
<span class="co">#&gt; 6    405  93     1          2</span>
<span class="co">#&gt; 7    497 112     1          1</span>
<span class="co">#&gt; 8    608 112     1          2</span>
<span class="co">#&gt; 9    719  71     1          1</span>
<span class="co">#&gt; 10   789  71     1          2</span>

## Plot segmetation results
<span class="kw">out.plot1</span>(x, out)</code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
</div>
</div>
<div id="examples-4-signals-simulated-with-noise-length-of-pattern-occurrences-and-pattern-shape-vary" class="section level2">
<h2 class="hasAnchor">
<a href="#examples-4-signals-simulated-with-noise-length-of-pattern-occurrences-and-pattern-shape-vary" class="anchor"></a>Examples 4: signals simulated with noise, length of pattern occurrences and pattern shape vary</h2>
<div id="simulate-data-3" class="section level3">
<h3 class="hasAnchor">
<a href="#simulate-data-3" class="anchor"></a>Simulate data</h3>
<p>Simulate data:</p>
<ul>
<li>add noise to a simulated time-series <code>x</code> (noise added is supposed to “hide” the pattern occurrences),</li>
<li>length of simulated pattern occurrences varies (vector length ranges between <code>60</code> and <code>120</code>),</li>
<li>two different true pattern shapes within a time-series <code>x</code>.</li>
</ul>
<p>Here, we re-use signal <code>x</code> from data generated above in <em>Examples 3</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Add noise to a  signal `x` from data generated in *Examples 3*.
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">1</span>)
x2 &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x), <span class="dt">sd =</span> <span class="fl">0.5</span>)

## Plot time-series `x`
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x2), <span class="dt">y =</span> x2) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y), <span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"Time [s]"</span>, <span class="dt">y =</span> <span class="st">"Value"</span>, <span class="dt">title =</span> <span class="st">"Time-series x"</span>)</code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
</div>
<div id="example-4a-run-simple-segmentation" class="section level3">
<h3 class="hasAnchor">
<a href="#example-4a-run-simple-segmentation" class="anchor"></a>Example 4(a): run simple segmentation</h3>
<p>We use two distinct pattern templates, as used in data generation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pattern.dur.seq &lt;-<span class="st"> </span><span class="dv">60</span><span class="op">:</span><span class="dv">120</span>
template &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(true.pattern.<span class="dv">1</span>,
                 true.pattern.<span class="dv">2</span>)
  
out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x2,
                      <span class="dt">x.fs =</span> <span class="dv">1</span>,
                      <span class="dt">template =</span> template,
                      <span class="dt">pattern.dur.seq =</span> pattern.dur.seq,
                      <span class="dt">similarity.measure =</span> <span class="st">"cor"</span>,
                      <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>)
out
<span class="co">#&gt;    tau_i T_i     sim_i template_i</span>
<span class="co">#&gt; 1      2  72 0.8535560          1</span>
<span class="co">#&gt; 2     76  78 0.7624407          2</span>
<span class="co">#&gt; 3    156  75 0.7818015          1</span>
<span class="co">#&gt; 4    234  72 0.6939557          2</span>
<span class="co">#&gt; 5    305 109 0.8512611          1</span>
<span class="co">#&gt; 6    413  75 0.6190537          2</span>
<span class="co">#&gt; 7    497 109 0.8228649          1</span>
<span class="co">#&gt; 8    608 108 0.7349471          2</span>
<span class="co">#&gt; 9    717  76 0.8293969          1</span>
<span class="co">#&gt; 10   792  61 0.5502773          2</span>

## Plot segmetation results
<span class="kw">out.plot1</span>(x2, out)</code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
</div>
<div id="example-4b-use-x-adept-ma-w-argument-to-smooth-time-series-x-for-similarity-matrix-computation-purpose" class="section level3">
<h3 class="hasAnchor">
<a href="#example-4b-use-x-adept-ma-w-argument-to-smooth-time-series-x-for-similarity-matrix-computation-purpose" class="anchor"></a>Example 4(b): use <code>x.adept.ma.W</code> argument to smooth time-series <code>x</code> for similarity matrix computation purpose</h3>
<p>One may consider using a smoothed version of a time-series <code>x</code> for the purposes of computing similarity between a time-series <code>x</code> and pattern template(s). To do this, the argument <code>x.adept.ma.W</code> is used to define a length of a window used in moving average smoothing of a time-series <code>x</code>; <code>W</code> is expressed in seconds. The default is <code>NULL</code> (no smoothing applied).</p>
<p><strong>Smoothing of a time-series <code>x</code></strong></p>
<p>To get a sense what <code>W</code> should be used as a length of a window used in moving average smoothing, one may use <code>windowSmooth</code> function to experiment with different values.</p>
<ul>
<li>Here, <code>W = 10</code> seems like a plausible choice, that is, the smoothed signal seems to be stripped out of much of a noise but still preserve the underlying pattern.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x2.smoothed &lt;-<span class="st"> </span><span class="kw"><a href="../reference/windowSmooth.html">windowSmooth</a></span>(<span class="dt">x =</span> x2, <span class="dt">x.fs =</span> <span class="dv">1</span>, <span class="dt">W =</span> <span class="dv">10</span>)

<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x2.smoothed), <span class="dt">y =</span> x2.smoothed) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"Time [s]"</span>, <span class="dt">y =</span> <span class="st">"Value"</span>, <span class="dt">title =</span> <span class="st">"Time-series x smoothed"</span>)
<span class="co">#&gt; Warning: Removed 8 rows containing missing values (geom_path).</span></code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-23-1.png" width="672"></p>
<p>We shall see that compared to the <em>Example 4(a)</em>, the effect of using a smoothed version of a time-series <code>x</code> in similarity matrix computation is pronounced in <code>sim_i</code> values in the resulted data frame as well as in a slight change in <code>tau_i</code> and <code>T_i</code> values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x2,
                      <span class="dt">x.fs =</span> <span class="dv">1</span>,
                      <span class="dt">template =</span> template,
                      <span class="dt">pattern.dur.seq =</span> pattern.dur.seq,
                      <span class="dt">similarity.measure =</span> <span class="st">"cor"</span>,
                      <span class="dt">x.adept.ma.W =</span> <span class="dv">10</span>,
                      <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>)
out
<span class="co">#&gt;    tau_i T_i     sim_i template_i</span>
<span class="co">#&gt; 1      4  69 0.9935740          1</span>
<span class="co">#&gt; 2     76  79 0.9607909          2</span>
<span class="co">#&gt; 3    158  70 0.9831188          1</span>
<span class="co">#&gt; 4    233  78 0.9818980          2</span>
<span class="co">#&gt; 5    312  95 0.9823877          1</span>
<span class="co">#&gt; 6    406  88 0.9510599          2</span>
<span class="co">#&gt; 7    495 114 0.9821003          1</span>
<span class="co">#&gt; 8    608 111 0.9879948          2</span>
<span class="co">#&gt; 9    718  72 0.9942539          1</span>
<span class="co">#&gt; 10   790  66 0.9398574          2</span>

## Plot segmetation results
<span class="kw">out.plot1</span>(x2, out)</code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-24-1.png" width="672"></p>
</div>
<div id="example-4c-use-finetune-finetune-maxima-nbh-w-arguments-to-employ-maxima-fine-tune-procedure" class="section level3">
<h3 class="hasAnchor">
<a href="#example-4c-use-finetune-finetune-maxima-nbh-w-arguments-to-employ-maxima-fine-tune-procedure" class="anchor"></a>Example 4(c): use <code>finetune</code>, <code>finetune.maxima.nbh.W</code> arguments to employ “maxima” fine-tune procedure</h3>
<p>We continue to use the segmentation setting similar to the one we used above in <em>Example 4(b)</em>, but this time we employ a fine-tuning procedure of stride locations.</p>
<p><strong>“maxima” fine-tune procedure</strong></p>
<p>“maxima” fine-tune procedure tunes preliminarily identified locations of pattern occurrence beginning and end so as they correspond to local maxima of time-series <code>x</code> (or smoothed version of <code>x</code>, as we shall see later) found within neighbourhoods of preliminary locations.</p>
<p>The parameter <code>finetune.maxima.nbh.W</code> defines a length of the two neighborhoods centered at preliminarily identified pattern occurrence beginning and end points within which we search for local maxima. (see <code>segmentPattern</code> documentation for more details).</p>
<p>We shall see from the plot of segmentation results below that almost all identified pattern occurrence start / end points are hitting the time point our eyes identify as “local signal maxima”.</p>
<ul>
<li>Possibly the only exception is around time point <code>600</code>; that comes from the restriction we imposed on the pattern duration times by setting <code>pattern.dur.seq &lt;- 60:120</code>, that is, the pattern occurrence cannot be longer than <code>120</code>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x2,
                      <span class="dt">x.fs =</span> <span class="dv">1</span>,
                      <span class="dt">template =</span> template,
                      <span class="dt">pattern.dur.seq =</span> pattern.dur.seq,
                      <span class="dt">similarity.measure =</span> <span class="st">"cor"</span>,
                      <span class="dt">x.adept.ma.W =</span> <span class="dv">10</span>,
                      <span class="dt">finetune =</span> <span class="st">"maxima"</span>,
                      <span class="dt">finetune.maxima.nbh.W =</span> <span class="dv">30</span>,
                      <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>)
out
<span class="co">#&gt;    tau_i T_i     sim_i template_i</span>
<span class="co">#&gt; 1      4  67 0.9935740          1</span>
<span class="co">#&gt; 2     70  78 0.9123034          2</span>
<span class="co">#&gt; 3    147  80 0.9831188          1</span>
<span class="co">#&gt; 4    226  78 0.9327744          2</span>
<span class="co">#&gt; 5    303 100 0.9823877          1</span>
<span class="co">#&gt; 6    402  94 0.9559945          2</span>
<span class="co">#&gt; 7    495 115 0.9823238          1</span>
<span class="co">#&gt; 8    615 104 0.9879948          2</span>
<span class="co">#&gt; 9    718  75 0.9942539          1</span>
<span class="co">#&gt; 10   792  61 0.9373485          2</span>

## Plot segmetation results
<span class="kw">out.plot1</span>(x2, out)</code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-25-1.png" width="672"></p>
</div>
<div id="example-4d-use-finetune-finetune-maxima-ma-w-finetune-maxima-nbh-w-arguments-to-employ-maxima-fine-tune-procedure-and-smooth-signal-for-peak-detection" class="section level3">
<h3 class="hasAnchor">
<a href="#example-4d-use-finetune-finetune-maxima-ma-w-finetune-maxima-nbh-w-arguments-to-employ-maxima-fine-tune-procedure-and-smooth-signal-for-peak-detection" class="anchor"></a>Example 4(d): use <code>finetune</code>, <code>finetune.maxima.ma.W</code>, <code>finetune.maxima.nbh.W</code> arguments to employ “maxima” fine-tune procedure and smooth signal for peak detection</h3>
<p>One other step that can be made in “maxima” fine-tune procedure is to use a smoothed version of a signal for peak detection. Here, we smooth a time-series <code>x</code> for <em>both</em> similarity matrix computation procedure and for “maxima” fine-tune procedure.</p>
<p>We would typically choose a more aggressive smoothing for a “maxima” fine-tune procedure (as defined via smoothing window length <code>finetune.maxima.ma.W</code>) than for similarity matrix computation (as defined via smoothing window length <code>x.adept.ma.W</code>); the reason is that often an aggressive smoothing is needed to remove (“smooth together”) multiple local maxima of a time-series <code>x</code>.</p>
<p>We again use <code>windowSmooth</code> function to experiment with different values of a window length in moving average smoothing.</p>
<ul>
<li>Here, <code>W = 50</code> seems like a plausible choice as it removes (“smooth together”) multiple local maxima of a time-series <code>x</code>, leaving out a single one.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x2.smoothed &lt;-<span class="st"> </span><span class="kw"><a href="../reference/windowSmooth.html">windowSmooth</a></span>(<span class="dt">x =</span> x2, <span class="dt">x.fs =</span> <span class="dv">1</span>, <span class="dt">W =</span> <span class="dv">50</span>)

<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x2.smoothed), <span class="dt">y =</span> x2.smoothed) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"Time [s]"</span>, <span class="dt">y =</span> <span class="st">"Value"</span>, <span class="dt">title =</span> <span class="st">"Time-series x smoothed aggresively"</span>)
<span class="co">#&gt; Warning: Removed 48 rows containing missing values (geom_path).</span></code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-26-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pattern.dur.seq &lt;-<span class="st"> </span><span class="dv">60</span><span class="op">:</span><span class="dv">120</span>
template &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(true.pattern.<span class="dv">1</span>,
                 true.pattern.<span class="dv">2</span>)
  
out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/segmentPattern.html">segmentPattern</a></span>(<span class="dt">x =</span> x2,
          <span class="dt">x.fs =</span> <span class="dv">1</span>,
          <span class="dt">template =</span> template,
          <span class="dt">pattern.dur.seq =</span> pattern.dur.seq,
          <span class="dt">similarity.measure =</span> <span class="st">"cor"</span>,
          <span class="dt">x.adept.ma.W =</span> <span class="dv">10</span>,  ## smoothing parameter for similarity matrix computation
          <span class="dt">finetune =</span> <span class="st">"maxima"</span>,  ## use fine-tuning
          <span class="dt">finetune.maxima.ma.W =</span> <span class="dv">50</span>, ## smoothing parameter for peak detection in fine-tuning
          <span class="dt">finetune.maxima.nbh.W =</span> <span class="dv">30</span>,  ## neighborhoods length in fine-tuning
          <span class="dt">compute.template.idx =</span> <span class="ot">TRUE</span>)
out
<span class="co">#&gt;    tau_i T_i     sim_i template_i</span>
<span class="co">#&gt; 1      1  72 0.9935740          1</span>
<span class="co">#&gt; 2     72  85 0.9607909          2</span>
<span class="co">#&gt; 3    156  75 0.9831188          1</span>
<span class="co">#&gt; 4    230  84 0.9818980          2</span>
<span class="co">#&gt; 5    313  90 0.9823877          1</span>
<span class="co">#&gt; 6    402  97 0.9627633          1</span>
<span class="co">#&gt; 7    498 109 0.9815284          1</span>
<span class="co">#&gt; 8    606 110 0.9828041          2</span>
<span class="co">#&gt; 9    715  75 0.9942539          1</span>
<span class="co">#&gt; 10   789  60 0.9398574          2</span></code></pre></div>
<p>The plot below shows the segmentation results</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Function to plot nice results visualization 
out.plot2 &lt;-<span class="st"> </span><span class="cf">function</span>(val, val.sm, out){
  yrange &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(val))
  y.h &lt;-<span class="st"> </span><span class="dv">0</span>
  plt &lt;-<span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(val), <span class="dt">y =</span> val), 
              <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y), 
              <span class="dt">color =</span> <span class="st">"grey"</span>) 
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(out)){
    tau1_i &lt;-<span class="st"> </span>out[i, <span class="st">"tau_i"</span>]
    tau2_i &lt;-<span class="st"> </span>tau1_i <span class="op">+</span><span class="st"> </span>out[i, <span class="st">"T_i"</span>] <span class="op">-</span><span class="st"> </span><span class="dv">1</span>
    plt &lt;-<span class="st"> </span>
<span class="st">      </span>plt <span class="op">+</span><span class="st"> </span>
<span class="st">      </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="dt">xintercept =</span> tau1_i, <span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">      </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(<span class="dt">xintercept =</span> tau2_i, <span class="dt">color =</span> <span class="st">"red"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">      </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span>(
        <span class="st">"rect"</span>,
        <span class="dt">fill =</span> <span class="st">"pink"</span>, 
        <span class="dt">alpha =</span> <span class="fl">0.3</span>,
        <span class="dt">xmin =</span> tau1_i, 
        <span class="dt">xmax =</span> tau2_i, 
        <span class="dt">ymin =</span> yrange[<span class="dv">1</span>],
        <span class="dt">ymax =</span> yrange[<span class="dv">2</span>]
    )
  }
  plt &lt;-<span class="st"> </span>
<span class="st">    </span>plt <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(val.sm), <span class="dt">y =</span> val.sm), 
              <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y), 
              <span class="dt">color =</span> <span class="st">"black"</span>, <span class="dt">size =</span> <span class="fl">0.6</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>(<span class="dt">base_size =</span> <span class="dv">9</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"Time [s]"</span>, 
         <span class="dt">y =</span> <span class="st">"Black line: smoothed x"</span>, 
         <span class="dt">title =</span><span class="st">"Light gray line: signal x</span><span class="ch">\n</span><span class="st">Black line: smoothed signal x</span><span class="ch">\n</span><span class="st">Red vertical lines: start and end points of identified pattern occurrence</span><span class="ch">\n</span><span class="st">Red shaded area: area corresponding to identified pattern occurrence"</span>)
  <span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(plt)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Plot segmetation results
<span class="kw">out.plot2</span>(x2, <span class="kw"><a href="../reference/windowSmooth.html">windowSmooth</a></span>(<span class="dt">x =</span> x2, <span class="dt">x.fs =</span> <span class="dv">1</span>, <span class="dt">W =</span> <span class="dv">50</span>), out)
<span class="co">#&gt; Warning: Removed 48 rows containing missing values (geom_path).</span></code></pre></div>
<p><img src="adept-intro_files/figure-html/unnamed-chunk-29-1.png" width="672"></p>
</div>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>References:</p>
<p>1: Karas, M., Straczkiewicz, M., Fadel, W., Harezlak, J., Crainiceanu, C., Urbanek, J.K. <em>Adaptive empirical pattern transformation (ADEPT) with application to walking stride segmentation</em>, Submitted to <em>Biostatistics</em>, 2018.</p>
<p>2: Karas, M. <em>Walking strides segmentation with <code>adept</code></em> package vignette.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#intro">Intro</a></li>
      <li>
<a href="#adept-method">ADEPT method</a><ul class="nav nav-pills nav-stacked">
<li><a href="#pattern-template">Pattern template</a></li>
      </ul>
</li>
      <li><a href="#install-and-load-adept-package">Install and load <code>adept</code> package</a></li>
      <li>
<a href="#pattern-segmentation-with-adept-package">Pattern segmentation with <code>adept</code> package</a><ul class="nav nav-pills nav-stacked">
<li><a href="#examples-1-signals-simulated-with-no-noise-same-length-of-all-pattern-occurrences">Examples 1: signals simulated with no noise, same length of all pattern occurrences</a></li>
      <li><a href="#examples-2-signals-simulated-with-no-noise-length-of-pattern-occurrences-varies">Examples 2: signals simulated with no noise, length of pattern occurrences varies</a></li>
      <li><a href="#examples-3-signals-simulated-with-no-noise-length-of-pattern-occurrences-and-pattern-shape-vary">Examples 3: signals simulated with no noise, length of pattern occurrences and pattern shape vary</a></li>
      <li><a href="#examples-4-signals-simulated-with-noise-length-of-pattern-occurrences-and-pattern-shape-vary">Examples 4: signals simulated with noise, length of pattern occurrences and pattern shape vary</a></li>
      </ul>
</li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Marta Karas, Jacek Urbanek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
